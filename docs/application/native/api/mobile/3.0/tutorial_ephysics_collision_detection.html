<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: EPhysics - Collision Detection</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">EPhysics - Collision Detection </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this example is to demonstrate the EPhysics Collision Detection usage - The code adds two balls, one with impulse and the second with a collision detection callback, to show an effect.</p>
<div class="image">
<img src="collision_detection.png" alt="collision_detection.png"/>
</div>
 <p>For this example we'll have an EPhysics_World, and two basic EPhysics_Bodys, we'll apply an impulse in one of then and the other will be stopped "waiting" for a collision.</p>
<p>The basic concepts like - initializing an EPhysics_World, render geometry, physics limiting boundaries, add an Ephysics_Body, associate it to evas objects, change restitution, friction and impulse properties, were already covered in <a class="el" href="tutorial_ephysics_bouncing_ball.html">EPhysics - Bouncing Ball</a></p>
<h2><a class="anchor" id="add-collstruct"></a>
Collision Data Struct</h2>
<p>While in this example we'll be working with a struct to hold some objects in our code. For clarity sake we present you the struct declaration in the following block.</p>
<p><div class="fragment"><pre class="fragment"><span class="keyword">struct </span>_Collision_Data {
     Test_Data base;
     <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *impact;
     EPhysics_Body *sphere;
     EPhysics_Body *sphere2;
};
</pre></div></p>
<h2><a class="anchor" id="add-callbacks"></a>
Adding the Callback</h2>
<p>Calling ephysics_body_event_callback_add() will register a callback to a type of physics body event.</p>
<p>EPHYSICS_CALLBACK_BODY_COLLISION : called just after the collision has been actually processed by the physics engine. In other words, to be notified about a collision between two physical bodies.</p>
<p><div class="fragment"><pre class="fragment">   ephysics_body_event_callback_add(collision_data-&gt;sphere,
                                    EPHYSICS_CALLBACK_BODY_COLLISION,
                                    _collision_cb, collision_data);
</pre></div></p>
<p>See _EPhysics_Callback_Body_Type for more event types.</p>
<h2><a class="anchor" id="add-collcb"></a>
Collision Function</h2>
<p>The callback function will filter the collision to be sure if that body is which we want and then show the effect.</p>
<p>First we need to create a specific variable type to get collision infos: EPhysics_Body_Collision</p>
<p><div class="fragment"><pre class="fragment">_collision_cb(<span class="keywordtype">void</span> *data, EPhysics_Body *body __UNUSED__, <span class="keywordtype">void</span> *event_info)
{
   EPhysics_Body *contact_body;
   Collision_Data *collision_data = data;
   EPhysics_Body_Collision *collision = event_info;
   <span class="keywordtype">int</span> x, y, z;
</pre></div></p>
<p>Now we want to know which body collides with and filter it.</p>
<p><div class="fragment"><pre class="fragment">   contact_body = ephysics_body_collision_contact_body_get(collision);
   <span class="keywordflow">if</span> (contact_body != collision_data-&gt;sphere2) <span class="keywordflow">return</span>;
</pre></div></p>
<p>We just get the collision position, move the impact effect to this coordinate and send a signal to edje to show it.</p>
<p><div class="fragment"><pre class="fragment">   ephysics_body_collision_position_get(collision, &amp;x, &amp;y, &amp;z);

   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(collision_data-&gt;impact, x - 10, y - 40);
   <a class="code" href="group__Elm__General.html#ga1beada7edf5d714c0dba5459bcc993fc">elm_object_signal_emit</a>(collision_data-&gt;impact, <span class="stringliteral">&quot;impact,show&quot;</span>,
                          <span class="stringliteral">&quot;ephysics_test&quot;</span>);
}
</pre></div></p>
<p>Here we finish the example. The full source code can be found at <a class="el" href="test_collision_detection_c.html">test_collision_detection.c</a>. </p>
</div></div><!-- contents -->
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
