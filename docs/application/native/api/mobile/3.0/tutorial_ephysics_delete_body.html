<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: EPhysics - Delete Body</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">3.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tutorial_ephysics_delete_body.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">EPhysics - Delete Body </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this example is to demonstrate the EPhysics Callbacks usage - The code adds two balls, one with impulse and the second with a collision detection callback, to delete the body.</p>
<p>For this example we'll have an EPhysics_World and two basic EPhysics_Bodys, we'll apply an impulse in one of then and the other will be stopped "waiting" for a collision.</p>
<p>The basic concepts like - initializing an EPhysics_World, render geometry, physics limiting boundaries, add an EPhysics_Body, associate it to evas objects, change restitution, friction and impulse properties, were already covered in <a class="el" href="tutorial_ephysics_bouncing_ball.html">EPhysics - Bouncing Ball</a></p>
<h2><a class="anchor" id="add-callbacks"></a>
Adding the Callback</h2>
<p>Calling ephysics_body_event_callback_add() registers a callback to a given EPhysics_Body event type.</p>
<p>We'll use two types:</p>
<p>EPHYSICS_CALLBACK_BODY_DEL : called when a body deletion has been issued and just before the deletion actually happens. In other words, to know that body has been marked for deletion. Typically to free some data associated with the body.</p>
<p><div class="fragment"><pre class="fragment">   ephysics_body_event_callback_add(sphere_body1,
                                    EPHYSICS_CALLBACK_BODY_DEL,
                                    _del_cb, collision_data);
</pre></div></p>
<p>The callback function will receive the collision_data and free some data associated with the body.</p>
<p><div class="fragment"><pre class="fragment">_del_cb(<span class="keywordtype">void</span> *data, EPhysics_Body *body, <span class="keywordtype">void</span> *event_info __UNUSED__)
{
   Collision_Data *collision_data = data;
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *obj, *shadow;

   obj = ephysics_body_evas_object_get(body);
   shadow = <a class="code" href="group__Evas__Object__Group__Extras.html#gafbad43015793eda4ae50202c0ce0e652">evas_object_data_get</a>(obj, <span class="stringliteral">&quot;shadow&quot;</span>);

   collision_data-&gt;base.evas_objs = <a class="code" href="group__Eina__List__Group.html#ga7c0c6e07aa592a1cb2e010049a718035" title="Removes the first instance of the specified data from the given list.">eina_list_remove</a>(
      collision_data-&gt;base.evas_objs, shadow);
   collision_data-&gt;base.evas_objs = <a class="code" href="group__Eina__List__Group.html#ga7c0c6e07aa592a1cb2e010049a718035" title="Removes the first instance of the specified data from the given list.">eina_list_remove</a>(
      collision_data-&gt;base.evas_objs, obj);

   <a class="code" href="group__Evas__Font__Group.html#ga7e7a625dab7a3890532aa13b43117076">evas_object_del</a>(shadow);
   <a class="code" href="group__Evas__Font__Group.html#ga7e7a625dab7a3890532aa13b43117076">evas_object_del</a>(obj);

   collision_data-&gt;sphere = NULL;
}
</pre></div></p>
<p>EPHYSICS_CALLBACK_BODY_COLLISION : called just after the collision has been actually processed by the physics engine. In other words, to be notified about a collision between two physical bodies.</p>
<p><div class="fragment"><pre class="fragment">   ephysics_body_event_callback_add(collision_data-&gt;sphere,
                                    EPHYSICS_CALLBACK_BODY_COLLISION,
                                    _collision_cb, collision_data);
</pre></div></p>
<p>The callback function will get the collision body and check if its body is equal to which we want to delete.</p>
<p><div class="fragment"><pre class="fragment">_collision_cb(<span class="keywordtype">void</span> *data, EPhysics_Body *body, <span class="keywordtype">void</span> *event_info)
{
   EPhysics_Body_Collision *collision = event_info;
   Collision_Data *collision_data = data;
   EPhysics_Body *contact_body;

   contact_body = ephysics_body_collision_contact_body_get(collision);
   <span class="keywordflow">if</span> (contact_body != collision_data-&gt;sphere2) <span class="keywordflow">return</span>;

   collision_data-&gt;base.bodies = <a class="code" href="group__Eina__List__Group.html#ga7c0c6e07aa592a1cb2e010049a718035" title="Removes the first instance of the specified data from the given list.">eina_list_remove</a>(collision_data-&gt;base.bodies,
                                                  body);

   INF(<span class="stringliteral">&quot;Collision Detected&quot;</span>);
   ephysics_body_del(body);
}
</pre></div></p>
<p>See _EPhysics_Callback_Body_Type for more event types.</p>
<p>Here we finish the example. The full source code can be found at <a class="el" href="test_delete_c.html">test_delete.c</a>. </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
