<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: complex-types-client-eina-value.c</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">complex-types-client-eina-value.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Client to test complex types (arrays, structs, dicts) against a provided server (<a class="el" href="complex-types-server_8c-example.html">complex-types-server::c</a>) returning them as <a class="el" href="group__Eina__Value.html">Eina_Value to/from Message</a>.</p>
<div class="fragment"><pre class="fragment"><span class="comment">//Compile with:</span>
<span class="comment">// gcc -o complex-types-client-eina-value complex-types-client-eina-value.c `pkg-config --cflags --libs eldbus ecore eina`</span>

<span class="preprocessor">#include &quot;Eldbus.h&quot;</span>
<span class="preprocessor">#include &lt;Ecore.h&gt;</span>

<span class="preprocessor">#define BUS &quot;com.profusion&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">#define PATH &quot;/com/profusion/Test&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">#define IFACE &quot;com.profusion.Test&quot;</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define size_of_array 5</span>
<span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *array_string[] = {
   <span class="stringliteral">&quot;aaaa&quot;</span>, <span class="stringliteral">&quot;bbbb&quot;</span>, <span class="stringliteral">&quot;cccc&quot;</span>, <span class="stringliteral">&quot;dddd&quot;</span>, <span class="stringliteral">&quot;eeee&quot;</span>
};

<span class="keyword">typedef</span> <span class="keyword">struct </span>_sub_struct
{
   <span class="keywordtype">char</span> *txt;
   <span class="keywordtype">int</span> num;
} sub_struct;

<span class="keyword">typedef</span> <span class="keyword">struct </span>_main_struct
{
   <span class="keywordtype">int</span> size;
   sub_struct array[];
} main_struct;

<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
_type_offset(<span class="keywordtype">unsigned</span> base, <span class="keywordtype">unsigned</span> size)
{
   <span class="keywordtype">unsigned</span> padding;
   <span class="keywordflow">if</span> (!(base % size))
     <span class="keywordflow">return</span> base;
   padding = abs(base - size);
   <span class="keywordflow">return</span> base + padding;
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_fill_receive_array_of_string_int_with_size(<a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <span class="keywordtype">int</span> size, <span class="keyword">const</span> <span class="keywordtype">char</span> *array[])
{
   <a name="_a0"></a><a class="code" href="struct__Eina__Value.html">Eina_Value</a> *value_struct, *value_array;
   <span class="keywordtype">int</span> i;
   <span class="keywordtype">unsigned</span> offset;
   <a name="_a1"></a><a class="code" href="struct__Eina__Value__Struct__Member.html">Eina_Value_Struct_Member</a> main_members[2];
   <a class="code" href="struct__Eina__Value__Struct__Member.html">Eina_Value_Struct_Member</a> sub_members[] = {
      <a name="a2"></a><a class="code" href="group__Eina__Value__Struct__Group.html#ga139206ef35b0b76e87eef56a202c0ae9">EINA_VALUE_STRUCT_MEMBER</a>(<a name="a3"></a><a class="code" href="group__Eina__Value__Group.html#ga916f76c8d5ffd4c3ee3c322a54efd0b7">EINA_VALUE_TYPE_STRING</a>, sub_struct, txt),
      <a class="code" href="group__Eina__Value__Struct__Group.html#ga139206ef35b0b76e87eef56a202c0ae9">EINA_VALUE_STRUCT_MEMBER</a>(<a name="a4"></a><a class="code" href="group__Eina__Value__Group.html#ga17974fd9ab773a3efefd591ffde58f77">EINA_VALUE_TYPE_INT</a>, sub_struct, num)
   };
   <a name="_a5"></a><a class="code" href="struct__Eina__Value__Struct__Desc.html">Eina_Value_Struct_Desc</a> desc_sub_struct = {
      <a name="a6"></a><a class="code" href="group__Eina__Value__Struct__Group.html#gae76aada4965672ce991f1f41baf71975">EINA_VALUE_STRUCT_DESC_VERSION</a>,
      NULL, <span class="comment">// no special operations</span>
      sub_members,
      2,
      <span class="keyword">sizeof</span>(sub_struct)
   };
   <a class="code" href="struct__Eina__Value__Struct__Desc.html">Eina_Value_Struct_Desc</a> desc_struct = {
      <a class="code" href="group__Eina__Value__Struct__Group.html#gae76aada4965672ce991f1f41baf71975">EINA_VALUE_STRUCT_DESC_VERSION</a>,
      NULL, <span class="comment">// no special operations</span>
      main_members,
      2,
      0<span class="comment">//will be set below</span>
   };

   offset = _type_offset(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="keyword">sizeof</span>(<a name="_a7"></a><a class="code" href="struct__Eina__Value__Array.html">Eina_Value_Array</a>));
   main_members[0].<a name="a8"></a><a class="code" href="struct__Eina__Value__Struct__Member.html#a96da971e28b1eef6a37f4c8b9d080b53">name</a> = <span class="stringliteral">&quot;size&quot;</span>;
   main_members[0].<a name="a9"></a><a class="code" href="struct__Eina__Value__Struct__Member.html#a615cdf08597bd18623c8c7daec7b4641">type</a> = <a class="code" href="group__Eina__Value__Group.html#ga17974fd9ab773a3efefd591ffde58f77">EINA_VALUE_TYPE_INT</a>;
   main_members[0].<a name="a10"></a><a class="code" href="struct__Eina__Value__Struct__Member.html#a5fe4db5cf87d3a7eeb865524fd615182">offset</a> = 0;
   main_members[1].<a class="code" href="struct__Eina__Value__Struct__Member.html#a96da971e28b1eef6a37f4c8b9d080b53">name</a> = <span class="stringliteral">&quot;array&quot;</span>;
   main_members[1].<a class="code" href="struct__Eina__Value__Struct__Member.html#a615cdf08597bd18623c8c7daec7b4641">type</a> = <a name="a11"></a><a class="code" href="group__Eina__Value__Group.html#ga8ec6d5bfa2fed9250e2dabc6d82d12c4">EINA_VALUE_TYPE_ARRAY</a>;
   main_members[1].<a class="code" href="struct__Eina__Value__Struct__Member.html#a5fe4db5cf87d3a7eeb865524fd615182">offset</a> = offset;
   desc_struct.size = offset + <span class="keyword">sizeof</span>(<a name="a12"></a><a class="code" href="group__Eina__Value__Array__Group.html#gaf031f54b3d2530ec31b5cd73a5b08fc2">Eina_Value_Array</a>);

   value_struct = <a name="a13"></a><a class="code" href="group__Eina__Value__Struct__Group.html#gaf469abb97ac59b73e8b2c726a58a78f8" title="Creates generic value storage of type struct.">eina_value_struct_new</a>(&amp;desc_struct);
   <a name="a14"></a><a class="code" href="group__Eina__Value__Struct__Group.html#ga476aa64a399aba776fa14f2fb065b268" title="Sets the generic value in an struct member.">eina_value_struct_set</a>(value_struct, <span class="stringliteral">&quot;size&quot;</span>, size);

   value_array = <a name="a15"></a><a class="code" href="group__Eina__Value__Array__Group.html#ga48893089e10fa1244e9fd82643b50c10" title="Creates generic value storage of type array.">eina_value_array_new</a>(<a name="a16"></a><a class="code" href="group__Eina__Value__Group.html#ga8147143699c5f5a686415090080d3f9e">EINA_VALUE_TYPE_STRUCT</a>, size);
   <span class="keywordflow">for</span> (i = 0; i &lt; size; i++)
     {
        <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *value_sub_struct = <a class="code" href="group__Eina__Value__Struct__Group.html#gaf469abb97ac59b73e8b2c726a58a78f8" title="Creates generic value storage of type struct.">eina_value_struct_new</a>(&amp;desc_sub_struct);
        <a name="_a17"></a><a class="code" href="struct__Eina__Value__Struct.html">Eina_Value_Struct</a> st;
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga476aa64a399aba776fa14f2fb065b268" title="Sets the generic value in an struct member.">eina_value_struct_set</a>(value_sub_struct, <span class="stringliteral">&quot;txt&quot;</span>, array[i]);
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga476aa64a399aba776fa14f2fb065b268" title="Sets the generic value in an struct member.">eina_value_struct_set</a>(value_sub_struct, <span class="stringliteral">&quot;num&quot;</span>, i);
        <a name="a18"></a><a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(value_sub_struct, &amp;st);
        <a name="a19"></a><a class="code" href="group__Eina__Value__Array__Group.html#ga82efa324a5f4b1d4d99002e1c9c78868" title="Appends a generic value in an array.">eina_value_array_append</a>(value_array, st);
        <a name="a20"></a><a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(value_sub_struct);
     }
   <a name="a21"></a><a class="code" href="group__Eina__Value__Struct__Group.html#gac22dc4bbaef8213a2ee79e2f03e9528b" title="Sets the member from Eina_Value source.">eina_value_struct_value_set</a>(value_struct, <span class="stringliteral">&quot;array&quot;</span>, value_array);

   <a name="a22"></a><a class="code" href="group__Eina__Value.html#ga525bec3d976a9489b27eb6ffa78cc4a6">eldbus_message_from_eina_value</a>(<span class="stringliteral">&quot;ia(si)&quot;</span>, msg, value_struct);

   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(value_struct);
   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(value_array);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
on_send_array(<span class="keywordtype">void</span> *data <a name="a23"></a><a class="code" href="group__Eina__Types__Group.html#ga82d751be730f849719ca292f9558be87">EINA_UNUSED</a>, <span class="keyword">const</span> <a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <a class="code" href="group__Eldbus__Core.html#ga7a5d4dc070bd925034de6e52c4260be7">Eldbus_Pending</a> *pending EINA_UNUSED)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *v, array;
   <span class="keyword">const</span> <span class="keywordtype">char</span> *txt;
   <span class="keywordtype">unsigned</span> i;
   printf(<span class="stringliteral">&quot;2 - on_send_array()\n&quot;</span>);

   <span class="keywordflow">if</span> (<a name="a24"></a><a class="code" href="group__Eldbus__Message.html#ga3aeec7d275bef2bb244ed9a045540921" title="Get the error text and name from a Eldbus_Message.">eldbus_message_error_get</a>(msg, NULL, NULL))
     {
        printf(<span class="stringliteral">&quot;Message error\n\n&quot;</span>);
        <span class="keywordflow">return</span>;
     }

   v = <a name="a25"></a><a class="code" href="group__Eina__Value.html#gaca1d745634fc1077b23d64ea0e4e7bca">eldbus_message_to_eina_value</a>(msg);
   <a name="a26"></a><a class="code" href="group__Eina__Value__Struct__Group.html#gadbe2da54625edad4a63dbce2cbbdf6ec" title="Gets the member as Eina_Value copy.">eina_value_struct_value_get</a>(v, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;array);
   <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a27"></a><a class="code" href="group__Eina__Value__Array__Group.html#ga758e2a63aa537f872bdbd07b87ea6115" title="Queries number of elements in value of array type.">eina_value_array_count</a>(&amp;array); i++)
     {
        <a name="a28"></a><a class="code" href="group__Eina__Value__Array__Group.html#ga9358dce2404ed0926db502539f8a1318" title="Gets the generic value from an array member.">eina_value_array_get</a>(&amp;array, i, &amp;txt);
        printf(<span class="stringliteral">&quot;\t%s\n&quot;</span>, txt);
     }

   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(v);
   <a name="a29"></a><a class="code" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68" title="Creates generic value storage.">eina_value_flush</a>(&amp;array);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
on_receive_array_with_size(<span class="keywordtype">void</span> *data EINA_UNUSED, <span class="keyword">const</span> <a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <a class="code" href="group__Eldbus__Core.html#ga7a5d4dc070bd925034de6e52c4260be7">Eldbus_Pending</a> *pending EINA_UNUSED)
{
   <span class="keyword">const</span> <span class="keywordtype">char</span> *errname;
   <span class="keyword">const</span> <span class="keywordtype">char</span> *errmsg;

   printf(<span class="stringliteral">&quot;1 - on_receive_array_with_size()\n&quot;</span>);
   <span class="keywordflow">if</span> (<a class="code" href="group__Eldbus__Message.html#ga3aeec7d275bef2bb244ed9a045540921" title="Get the error text and name from a Eldbus_Message.">eldbus_message_error_get</a>(msg, &amp;errname, &amp;errmsg))
     {
        fprintf(stderr, <span class="stringliteral">&quot;Error: %s %s\n&quot;</span>, errname, errmsg);
     }
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
on_plus_one(<span class="keywordtype">void</span> *data EINA_UNUSED, <span class="keyword">const</span> <a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <a class="code" href="group__Eldbus__Core.html#ga7a5d4dc070bd925034de6e52c4260be7">Eldbus_Pending</a> *pending EINA_UNUSED)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *v;
   <span class="keywordtype">int</span> num2;

   <span class="keywordflow">if</span> (<a class="code" href="group__Eldbus__Message.html#ga3aeec7d275bef2bb244ed9a045540921" title="Get the error text and name from a Eldbus_Message.">eldbus_message_error_get</a>(msg, NULL, NULL))
     {
        printf(<span class="stringliteral">&quot;Message error\n\n&quot;</span>);
        <span class="keywordflow">return</span>;
     }

   v = <a class="code" href="group__Eina__Value.html#gaca1d745634fc1077b23d64ea0e4e7bca">eldbus_message_to_eina_value</a>(msg);
   <a name="a30"></a><a class="code" href="group__Eina__Value__Struct__Group.html#ga07a7cc420f03a247dffe4d13ce1ad6c5" title="Gets the generic value from an struct member.">eina_value_struct_get</a>(v, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;num2);

   printf(<span class="stringliteral">&quot;3 - on_plus_one() %d\n&quot;</span>, num2);
   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(v);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
receive_variant_cb(<span class="keywordtype">void</span> *data EINA_UNUSED, <span class="keyword">const</span> <a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <a class="code" href="group__Eldbus__Core.html#ga7a5d4dc070bd925034de6e52c4260be7">Eldbus_Pending</a> *pending EINA_UNUSED)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *v, variant, array;
   <span class="keywordtype">unsigned</span> i;

   printf(<span class="stringliteral">&quot;4 - receive a variant with an array of strings\n&quot;</span>);
   <span class="keywordflow">if</span> (<a class="code" href="group__Eldbus__Message.html#ga3aeec7d275bef2bb244ed9a045540921" title="Get the error text and name from a Eldbus_Message.">eldbus_message_error_get</a>(msg, NULL, NULL))
     {
        printf(<span class="stringliteral">&quot;Message error\n\n&quot;</span>);
        <span class="keywordflow">return</span>;
     }

   v = <a class="code" href="group__Eina__Value.html#gaca1d745634fc1077b23d64ea0e4e7bca">eldbus_message_to_eina_value</a>(msg);

   <a class="code" href="group__Eina__Value__Struct__Group.html#gadbe2da54625edad4a63dbce2cbbdf6ec" title="Gets the member as Eina_Value copy.">eina_value_struct_value_get</a>(v, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;variant);
   <a class="code" href="group__Eina__Value__Struct__Group.html#gadbe2da54625edad4a63dbce2cbbdf6ec" title="Gets the member as Eina_Value copy.">eina_value_struct_value_get</a>(&amp;variant, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;array);
   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__Eina__Value__Array__Group.html#ga758e2a63aa537f872bdbd07b87ea6115" title="Queries number of elements in value of array type.">eina_value_array_count</a>(&amp;array); i++)
     {
        <span class="keyword">const</span> <span class="keywordtype">char</span> *txt;
        <a class="code" href="group__Eina__Value__Array__Group.html#ga9358dce2404ed0926db502539f8a1318" title="Gets the generic value from an array member.">eina_value_array_get</a>(&amp;array, i, &amp;txt);
        printf(<span class="stringliteral">&quot;\t%s\n&quot;</span>, txt);
     }

   <a class="code" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68" title="Creates generic value storage.">eina_value_flush</a>(&amp;array);
   <a class="code" href="group__Eina__Value__Value__Group.html#ga940660709a2862bafac92f47bb721a68" title="Creates generic value storage.">eina_value_flush</a>(&amp;variant);
   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(v);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_property_removed(<span class="keywordtype">void</span> *data EINA_UNUSED, <a class="code" href="group__Eldbus__Core.html#ga5598fdabe4f36f8c13ef7a07dc219a3c">Eldbus_Proxy</a> *proxy EINA_UNUSED, <span class="keywordtype">void</span> *event_info)
{
   <a class="code" href="group__Eldbus__Proxy.html#ga46567629e2af4af835fb9ef60f79c120">Eldbus_Proxy_Event_Property_Removed</a> *<span class="keyword">event</span> = event_info;

   printf(<span class="stringliteral">&quot;\nproperty removed: %s&quot;</span>, event-&gt;name);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_property_changed(<span class="keywordtype">void</span> *data EINA_UNUSED, <a class="code" href="group__Eldbus__Core.html#ga5598fdabe4f36f8c13ef7a07dc219a3c">Eldbus_Proxy</a> *proxy EINA_UNUSED, <span class="keywordtype">void</span> *event_info)
{
   <a class="code" href="group__Eldbus__Proxy.html#ga6512ecf438db7580a8faf7e2c152210c">Eldbus_Proxy_Event_Property_Changed</a> *<span class="keyword">event</span> = event_info;
   <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
   <span class="keyword">const</span> <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *value;
   printf(<span class="stringliteral">&quot;\nproperty changed\n&quot;</span>);

   name = <span class="keyword">event</span>-&gt;name;
   value = <span class="keyword">event</span>-&gt;<a name="a31"></a><a class="code" href="struct__Eina__Value.html#a3b07134cb8ddb664e83d414f99d55bf6">value</a>;

   <span class="keywordflow">if</span> (!strcmp(name, <span class="stringliteral">&quot;text&quot;</span>) || !strcmp(name, <span class="stringliteral">&quot;Resp2&quot;</span>))
     {
        <span class="keyword">const</span> <span class="keywordtype">char</span> *txt;
        <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(value, &amp;txt);
        printf(<span class="stringliteral">&quot;[%s] = %s\n&quot;</span>, name, txt);
     }
   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(name, <span class="stringliteral">&quot;int32&quot;</span>))
     {
        <span class="keywordtype">int</span> num;
        <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(value, &amp;num);
        printf(<span class="stringliteral">&quot;[%s] = %d\n&quot;</span>, name, num);
     }
   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(name, <span class="stringliteral">&quot;st&quot;</span>))
     {
        <span class="keyword">const</span> <span class="keywordtype">char</span> *txt;
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga07a7cc420f03a247dffe4d13ce1ad6c5" title="Gets the generic value from an struct member.">eina_value_struct_get</a>(value, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;txt);
        printf(<span class="stringliteral">&quot;[%s] %s | &quot;</span>, name, txt);
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga07a7cc420f03a247dffe4d13ce1ad6c5" title="Gets the generic value from an struct member.">eina_value_struct_get</a>(value, <span class="stringliteral">&quot;arg1&quot;</span>, &amp;txt);
        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, txt);
     }
}

<span class="keyword">static</span> <a class="code" href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a>
_read_cache(<span class="keywordtype">void</span> *data)
{
   <a class="code" href="group__Eldbus__Core.html#ga5598fdabe4f36f8c13ef7a07dc219a3c">Eldbus_Proxy</a> *proxy = data;
   <span class="keyword">const</span> <span class="keywordtype">char</span> *txt;
   <span class="keywordtype">int</span> num;
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *v;

   v = <a name="a32"></a><a class="code" href="group__Eldbus__FDO__Properties.html#ga07e236d5f577453308c1f80e48f1d2a3">eldbus_proxy_property_local_get</a>(proxy, <span class="stringliteral">&quot;text&quot;</span>);
   <span class="keywordflow">if</span> (v)
     {
        <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(v, &amp;txt);
        printf(<span class="stringliteral">&quot;Read cache: [txt] = %s\n&quot;</span>, txt);
     }

   v = <a class="code" href="group__Eldbus__FDO__Properties.html#ga07e236d5f577453308c1f80e48f1d2a3">eldbus_proxy_property_local_get</a>(proxy, <span class="stringliteral">&quot;int32&quot;</span>);
   <span class="keywordflow">if</span> (v)
     {
        <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(v, &amp;num);
        printf(<span class="stringliteral">&quot;Read cache: [int32] = %d\n&quot;</span>, num);
     }

   v = <a class="code" href="group__Eldbus__FDO__Properties.html#ga07e236d5f577453308c1f80e48f1d2a3">eldbus_proxy_property_local_get</a>(proxy, <span class="stringliteral">&quot;st&quot;</span>);
   <span class="keywordflow">if</span> (v)
     {
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga07a7cc420f03a247dffe4d13ce1ad6c5" title="Gets the generic value from an struct member.">eina_value_struct_get</a>(v, <span class="stringliteral">&quot;arg0&quot;</span>, &amp;txt);
        printf(<span class="stringliteral">&quot;Read cache: [st] %s | &quot;</span>, txt);
        <a class="code" href="group__Eina__Value__Struct__Group.html#ga07a7cc420f03a247dffe4d13ce1ad6c5" title="Gets the generic value from an struct member.">eina_value_struct_get</a>(v, <span class="stringliteral">&quot;arg1&quot;</span>, &amp;txt);
        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, txt);
     }

   <span class="keywordflow">return</span> <a name="a33"></a><a class="code" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>;
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_fill_plus_one(<a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg, <span class="keywordtype">int</span> num)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> *v;
   <a class="code" href="struct__Eina__Value__Struct__Member.html">Eina_Value_Struct_Member</a> main_members[] = {
      {<span class="stringliteral">&quot;num&quot;</span>, <a class="code" href="group__Eina__Value__Group.html#ga17974fd9ab773a3efefd591ffde58f77">EINA_VALUE_TYPE_INT</a>, 0}
   };
   <a class="code" href="struct__Eina__Value__Struct__Desc.html">Eina_Value_Struct_Desc</a> desc_struct = {
         <a class="code" href="group__Eina__Value__Struct__Group.html#gae76aada4965672ce991f1f41baf71975">EINA_VALUE_STRUCT_DESC_VERSION</a>,
         NULL, <span class="comment">// no special operations</span>
         main_members,
         1,
         <span class="keyword">sizeof</span>(int)
   };
   v = <a class="code" href="group__Eina__Value__Struct__Group.html#gaf469abb97ac59b73e8b2c726a58a78f8" title="Creates generic value storage of type struct.">eina_value_struct_new</a>(&amp;desc_struct);
   <a class="code" href="group__Eina__Value__Struct__Group.html#ga476aa64a399aba776fa14f2fb065b268" title="Sets the generic value in an struct member.">eina_value_struct_set</a>(v, <span class="stringliteral">&quot;num&quot;</span>, num);

   <a class="code" href="group__Eina__Value.html#ga525bec3d976a9489b27eb6ffa78cc4a6">eldbus_message_from_eina_value</a>(<span class="stringliteral">&quot;i&quot;</span>, msg, v);

   <a class="code" href="group__Eina__Value__Value__Group.html#gaa2aa7ac9d1fcd7c4497cf104cb374a52" title="Frees value and its data.">eina_value_free</a>(v);
}

<span class="keywordtype">int</span>
main(<span class="keywordtype">void</span>)
{
   <a class="code" href="group__Eldbus__Core.html#ga5f0557a7e65ed263fcc1678874b8f7e7">Eldbus_Connection</a> *conn;
   <a class="code" href="group__Eldbus__Core.html#ga49914ed24559a149426b5f2bb8294a06">Eldbus_Object</a> *obj;
   <a class="code" href="group__Eldbus__Core.html#ga5598fdabe4f36f8c13ef7a07dc219a3c">Eldbus_Proxy</a> *proxy;
   <a class="code" href="group__Eldbus__Core.html#ga14e8c4d4b96af5fb8bb5c66dc315593a">Eldbus_Message</a> *msg;

   <a name="a34"></a><a class="code" href="group__Ecore__Init__Group.html#ga77757609684a2c922dc5ec398274751b">ecore_init</a>();
   <a name="a35"></a><a class="code" href="group__Eldbus__Core.html#ga695dacda6632542dea454e39659ab54f" title="Initialize eldbus.">eldbus_init</a>();

   conn = <a name="a36"></a><a class="code" href="group__Eldbus__Conneciton.html#ga203ec794fc0c7e1bddce4eb18b628c04">eldbus_connection_get</a>(ELDBUS_CONNECTION_TYPE_SESSION);
   obj = <a name="a37"></a><a class="code" href="group__Eldbus__Object__Mapper.html#ga067d5c8eba2590fb58e7dc39de87d203" title="Get an object of the given bus and path.">eldbus_object_get</a>(conn, BUS, PATH);
   proxy = <a name="a38"></a><a class="code" href="group__Eldbus__Proxy.html#ga58b8d61188435800e1e866ab3fdc7090" title="Get a proxy of the following interface name in a Eldbus_Object.">eldbus_proxy_get</a>(obj, IFACE);

   msg = <a name="a39"></a><a class="code" href="group__Eldbus__Proxy.html#ga443bd02f44bf6c61c7b6c5ca4fde87de" title="Constructs a new message to invoke a method on a remote interface.">eldbus_proxy_method_call_new</a>(proxy, <span class="stringliteral">&quot;ReceiveArrayOfStringIntWithSize&quot;</span>);
   _fill_receive_array_of_string_int_with_size(msg, size_of_array, array_string);
   <a name="a40"></a><a class="code" href="group__Eldbus__Proxy.html#ga8e4268bf0000bd0ab9596bb2c4d86489" title="Send a message.">eldbus_proxy_send</a>(proxy, msg, on_receive_array_with_size, NULL, -1);

   <a name="a41"></a><a class="code" href="group__Eldbus__Proxy.html#ga0eaac8e928bd7605855bf61d97eea37c" title="Call a method in proxy. Send a method call to interface that proxy belong with data.">eldbus_proxy_call</a>(proxy, <span class="stringliteral">&quot;SendArray&quot;</span>, on_send_array, NULL, -1 , <span class="stringliteral">&quot;&quot;</span>);

   msg = <a class="code" href="group__Eldbus__Proxy.html#ga443bd02f44bf6c61c7b6c5ca4fde87de" title="Constructs a new message to invoke a method on a remote interface.">eldbus_proxy_method_call_new</a>(proxy, <span class="stringliteral">&quot;PlusOne&quot;</span>);
   _fill_plus_one(msg, 14);
   <a class="code" href="group__Eldbus__Proxy.html#ga8e4268bf0000bd0ab9596bb2c4d86489" title="Send a message.">eldbus_proxy_send</a>(proxy, msg, on_plus_one, NULL, -1);

   <a name="a42"></a><a class="code" href="group__Eldbus__Proxy.html#ga4b7ab0db8ac6ab9ea3e7f0912b2432e9" title="Add a callback function to be called when occurs a event of the type passed.">eldbus_proxy_event_callback_add</a>(proxy,
                                  <a name="a43"></a><a class="code" href="group__Eldbus__Proxy.html#ggae2651588bfdfc934519b1167ae42a14dac2f80df568c56bdfa293214c8de95add">ELDBUS_PROXY_EVENT_PROPERTY_CHANGED</a>,
                                  _property_changed, NULL);
   <a class="code" href="group__Eldbus__Proxy.html#ga4b7ab0db8ac6ab9ea3e7f0912b2432e9" title="Add a callback function to be called when occurs a event of the type passed.">eldbus_proxy_event_callback_add</a>(proxy, <a name="a44"></a><a class="code" href="group__Eldbus__Proxy.html#ggae2651588bfdfc934519b1167ae42a14daa2f041c65a6d134c2ae14043f4b24295">ELDBUS_PROXY_EVENT_PROPERTY_REMOVED</a>,
                                  _property_removed, NULL);

   <a name="a45"></a><a class="code" href="group__Eldbus__FDO__Properties.html#gaa2a20ccdb8dfe3fae539c9366eac9fb5">eldbus_proxy_properties_monitor</a>(proxy, <a name="a46"></a><a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>);
   <a name="a47"></a><a class="code" href="group__Ecore__Timer__Group.html#ga7b9cb9d24ecebfdbb957436e2e669402">ecore_timer_add</a>(10, _read_cache, proxy);

   <a class="code" href="group__Eldbus__Proxy.html#ga0eaac8e928bd7605855bf61d97eea37c" title="Call a method in proxy. Send a method call to interface that proxy belong with data.">eldbus_proxy_call</a>(proxy, <span class="stringliteral">&quot;ReceiveVariantData&quot;</span>, receive_variant_cb, NULL, -1, <span class="stringliteral">&quot;&quot;</span>);

   <a name="a48"></a><a class="code" href="group__Ecore__Main__Loop__Group.html#gaf103b9f668bb3e4fed12e52c6180132d">ecore_main_loop_begin</a>();

   <a name="a49"></a><a class="code" href="group__Eldbus__Proxy.html#gaa0c972c94ccaf39b0ca3586c5d549af4" title="Remove callback registered in eldbus_proxy_event_callback_add().">eldbus_proxy_event_callback_del</a>(proxy, <a class="code" href="group__Eldbus__Proxy.html#ggae2651588bfdfc934519b1167ae42a14dac2f80df568c56bdfa293214c8de95add">ELDBUS_PROXY_EVENT_PROPERTY_CHANGED</a>,
                                  _property_changed, NULL);
   <a name="a50"></a><a class="code" href="group__Eldbus__Conneciton.html#ga1c035aac8b601b416bba11d0d68f80ae" title="Decrement connection reference count.">eldbus_connection_unref</a>(conn);

   <a name="a51"></a><a class="code" href="group__Eldbus__Core.html#ga1162c16632b1d81e6dba6620397dcda9" title="Shutdown eldbus.">eldbus_shutdown</a>();
   <a name="a52"></a><a class="code" href="group__Ecore__Init__Group.html#ga768298b932f18d7e7593a447493e5cde">ecore_shutdown</a>();
   <span class="keywordflow">return</span> 0;
}
</pre></div> </div><!-- contents -->
</div><!-- contents -->
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
