<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Evas object smart objects</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Evas object smart objects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example, we illustrate how to create and handle Evas smart objects.</p>
<p>A smart object is one that provides custom functions to handle clipping, hiding, moving, resizing, color setting and more on <b>child</b> elements, automatically, for the smart object's user. They could be as simple as a group of objects that move together (see Evas_Smart_Object_Clipped) or implementations of whole complex UI widgets, providing some intelligence (thus the name) and extension to simple Evas objects.</p>
<p>Here, we create one as an example. What it does is to control (at maximum) 2 child objects, with regard to their geometries and colors. There can be a "left" child and a "right" one. The former will always occupy the top left quadrant of the smart object's area, while the latter will occupy the bottom right. The smart object will also contain an <b>internal</b> decorative border object, which will also be controlled by it, naturally.</p>
<p>Here is where we add it to the canvas: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The magic starts to happen in the <code>evas_smart_example_add()</code> function, which is one in the example smart object's defined <b>interface</b>. These should be the functions you would export to the users of your smart object. We made three for this one:</p>
<ul>
<li><code>evas_smart_example_add()</code>: add a new instance of the example smart object to a canvas</li>
<li><code>evas_smart_example_remove()</code>: remove a given child of the smart object from it</li>
<li><code>evas_smart_example_set_left()</code>: set the left child of the smart object</li>
<li><code>evas_smart_example_set_right()</code>: set the right child of the smart object</li>
</ul>
<p>The object's creation takes place as:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Smart objects are defined by <b>smart classes</b>, which are structs defining their interfaces, or <b>smart functions</b> (see <a class="el" href="group__Evas.html#gaea15f67e901bf5380cdb67dc1bb43391">Evas_Smart_Class</a>, the base class for any smart object). As you see, one has to use the <a class="el" href="group__Evas__Smart__Object__Group.html#gad80de73a33446f902d4b39141a8d0a05" title="Instantiates a new smart object described by s.">evas_object_smart_add()</a> function to instantiate smart objects. Its second parameter is what matters -- an <a class="el" href="group__Evas.html#ga7cdfd1afece1cad64c413eb9a778ddbb">Evas_Smart</a> struct, which contains all the smart class definitions (smart functions, smart callbacks, and the like). Note, however, that <code>_evas_smart_example_smart_class_new()</code> seems not to be defined in our example's code. That's because it came from a very handy <b>helper macro</b>:  <div class="fragment"><pre class="fragment"></pre></div> What it does is to <b>subclass</b> a given existing smart class, thus specializing it. This is very common and useful in Evas. There is a built-in smart object, the "clipped smart object", which implements a behavior mostly desired by many other smart object implementors: it will clip its children to its area and move them along with it, on <a class="el" href="group__Evas__Object__Group__Basic.html#ga02da8091bbac768b8e86c7b74b2a94f9" title="Move the given Evas object to the given location inside its canvas&#39; viewport.">evas_object_move()</a> calls. Then, our example smart object will get that behavior for free.</p>
<p>The first argument to the macro,  <div class="fragment"><pre class="fragment"></pre></div> will define the new smart class' name. The second tells the macro what is the <b>prefix</b> of the function it will be declaring with a <code>_smart_set_user()</code> suffix. On this function, we may override/extend any desired method from our parent smart class:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The first function pointer's code will take place at an example smart object's <b>creation</b> time:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The #EVAS_SMART_DATA_ALLOC macro will take care of allocating our smart object data, which will be available on other contexts for us (mainly in our interface functions):  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>See that, as we're inheriting from the clipped smart object's class, we <b>must</b> have their data struct as our first member. Other data of interest for us is a child members array and the border object's handle. The latter is what is created in the last mentioned function. Note how to tell Evas the border will be managed by our smart object from that time on: <code>evas_object_smart_member_add(priv-&gt;border, o);</code>. The counterpart of this function is exemplified on the smart object's interface function to remove children: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>At the end of that function we make use of an constant defined by the #EVAS_SMART_SUBCLASS_NEW: <code>_evas_smart_example_parent_sc</code>. It has the same prefix we passed to the macro, as you can see, and it holds a pointer to our <b>parent</b> smart class. Then, we can call the specialized method, itself, after our code. The <code>del</code>, <code>hide</code>, <code>show</code> and <code>resize</code> specializations are straightforward, we let the reader take a look at them below to check their behavior. What's interesting is the <code>calculate</code> one:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>This code will take place whenever the smart object itself is flagged "dirty", i.e., must be recalculated for rendering (that could come from changes on its clipper, resizing, moving, etc). There, we make sure the decorative border lies on the edges of the smart object and the children, if any, lie on their respective quadrants.</p>
<p>After instantiating our smart object, we do some checks to exemplify some of the API on smart objects:  <div class="fragment"><pre class="fragment"></pre></div> The <a class="el" href="group__Evas__Smart__Object__Group.html#ga257a2651b93de714211d4205c0e70bb9" title="Checks whether a given smart object or any of its smart object parents is of a given smart class...">evas_object_smart_type_check()</a> one will assure we have the string naming our smart class really set to the live object.</p>
<p>Other important things we also exemplify here are <b>smart callbacks</b> and smart callback <b>introspection:</b>  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Here we declare our array of smart callback descriptions, which has one element only, in this case. That callback will take place, as the name indicates, whenever the number of member objects in our smart object example instance changes. That global array variable must be the last argument to #EVAS_SMART_SUBCLASS_NEW, so that it's registered as the <b>smart class</b>'s callbacks description.</p>
<p>After we instantiate the smart object, we take a look on those descriptions and register a callback on that unique smart event:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The code of the callback will just print how many member objects we have, which is an integer argument of the callback itself, as flagged by its description:  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>One of the points at which we issue that callback is inside the <code>evas_smart_example_remove()</code>, code that was already shown.</p>
<p>As in other examples, to interact with this one there's a command line interface. A help string can be asked for with the 'h' key:  <div class="fragment"><pre class="fragment"></pre></div> Use 'l' and 'r' keys, to create new rectangles and place them on the left (<code>evas_smart_example_set_left()</code>) or right (<code>evas_smart_example_set_right()</code>) spots of our smart object, respectively. The 'w' command will remove all member objects from the smart object and delete them. The keyboard arrows will move the smart object along the canvas. See how it takes any child objects with it during its movement. The 'd' and 'i' keys will increase or decrease the smart object's size -- see how it affects the children's sizes, too. Finally, 'c' will change the color of the smart object's clipper (which is the exact internal clipper coming from a clipped smart object):  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>"Real life" examples of smart objects are Edje and Emotion objects: they both have independent libraries implementing their behavior. The full example follows.</p>
<div class="fragment"><pre class="fragment"></pre></div> </div></div><!-- contents -->
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
