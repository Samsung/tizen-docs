<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Eina_Value struct usage</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Eina_Value struct usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example will examine a hypothetical situation in which we had a structure(which represented parameters) with two fields, and then need to add a third field to our structure. If using structs directly we'd need to rewrite every piece of code that touches the struct, by using eina value, and thus having the compiler not even know the struct, we can reduce the amount of changes needed and retain interoperability between the old and new format.</p>
<p>Our example will start with a function that creates descriptions of both of our structs for eina value usage. The first step is to create a struct and describe its members: <div class="fragment"><pre class="fragment"></pre></div> </p>
<dl class="note"><dt><b>Note:</b></dt><dd>We can't pass the types of the members to EINA_VALUE_STRUCT_MEMBER macro because they are not constant initializers.</dd></dl>
<p>So far it should be pretty easy to understand, we said <code>My_Struct_V1</code> has two members, one of type <code>int</code> and another of type <code>char</code>. We now create the description of the actual struct, again nothing overly complex, we signal which version of EINA_VALUE_STRUCT we're using, we declare no special operations, our members and our size: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>We now repeat the process for the second version of our struct, the only difference is the addition of a third parameter of type <code>int</code> : <div class="fragment"><pre class="fragment"></pre></div></p>
<p>We'll now look at a function that sets the values of our structs. For simplicity's sake we initialize it we random values, a real world case would read these values from a file, a database or even from the network. The fundamental detail here is that this function works for both V1 and V2 structs, this is because setting a parameter that a struct that doesn't have does nothing without throwing any errors: <div class="fragment"><pre class="fragment"></pre></div> </p>
<dl class="note"><dt><b>Note:</b></dt><dd>While using eina_value_struct_set() with an in-existing parameter causes no error, it does return <a class="el" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>, to notify it was not possible to set the value. This could be used to determine that we're handling a V1 struct and take some action based on that.</dd></dl>
<p>The next thing is to do is see what a function that uses the values of the struct looks like. We'll again be very simplistic in our usage, we'll just print the values, but a real world case, might send these values to another process use them to open a network/database connection or anything else. Since all versions of the struct have <code>param1</code> and <code>param2</code> we'll unconditionally use them: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The next step is to conditionally use <code>param3</code>, which can fortunately be done in the same step in which we get it's value: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>There we've now got functions that can both populate and use values from both our structs, so now let's actually use them in our main function by creating a struct of each type, initializing them and them using them: <div class="fragment"><pre class="fragment"></pre></div></p>
<p>This concludes our example. For the full source code see <a class="el" href="eina_value_02_c.html">eina_value_02.c</a>. </p>
</div></div><!-- contents -->
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
