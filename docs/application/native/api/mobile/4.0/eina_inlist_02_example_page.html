<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Eina_Inlist advanced usage - lists and inlists</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">4.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('eina_inlist_02_example_page.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Eina_Inlist advanced usage - lists and inlists </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example describes the usage of <a class="el" href="group__Eina__Inline__List__Group.html#gad93973c87f867f249482e936797096ad">Eina_Inlist</a> mixed with <a class="el" href="group__Eina__List__Group.html#ga3295e1210efea1fb0fd6acbf3cbc1f29">Eina_List</a> . We create and add elements to an inlist, and the even members are also added to a normal list. Later we remove the elements divisible by 3 from this normal list.</p>
<p>The struct that is going to be used is the same used in <a class="el" href="eina_inlist_01_example_page.html">Eina_Inlist basic usage</a> , since we still need the <a class="el" href="group__Eina__Inline__List__Group.html#gab30a76fcfa50307c797491705d60136a">EINA_INLIST</a> macro to declare the inlist node info:</p>
<p><div class="fragment"><pre class="fragment"><span class="keyword">struct </span>my_struct {
     <a class="code" href="group__Eina__Inline__List__Group.html#gab30a76fcfa50307c797491705d60136a">EINA_INLIST</a>;
     <span class="keywordtype">int</span> a, b;
};
</pre></div></p>
<p>The resulting node representing this struct can be exemplified by the following picture:</p>
<div class="image">
<img src="eina_inlist-node_eg2-my-struct.png" alt="eina_inlist-node_eg2-my-struct.png"/>
</div>
  <p>Now we need some pointers and auxiliar variables that will help us iterate on the lists:</p>
<p><div class="fragment"><pre class="fragment">   <span class="keyword">struct </span>my_struct *d, *cur;
   <span class="keywordtype">int</span> i;

   <a class="code" href="struct__Eina__Inlist.html">Eina_Inlist</a> *inlist = NULL;
   <a class="code" href="struct__Eina__List.html">Eina_List</a> *list = NULL, *l_itr, *l_next;
</pre></div></p>
<p>Allocating 100 elements and putting them into an inlist, and the even elements also go to the normal list:</p>
<p><div class="fragment"><pre class="fragment">   <span class="keywordflow">for</span> (i = 0; i &lt; 100; i++)
     {
    d = malloc(<span class="keyword">sizeof</span>(*d));
    d-&gt;a = i;
    d-&gt;b = i * 10;
    inlist = <a class="code" href="group__Eina__Inline__List__Group.html#ga095c6abf8b0122e30271ce98c26c0524" title="Adds a new node to end of a list.">eina_inlist_append</a>(inlist, <a class="code" href="group__Eina__Inline__List__Group.html#ga5bc991428e75557c6195f6b9e38321fb">EINA_INLIST_GET</a>(d));
    <span class="keywordflow">if</span> ((i % 2) == 0)
      list = <a class="code" href="group__Eina__List__Group.html#ga9f35bfc7c5b798014c3e0a74bc6f39ad" title="Prepends the given data to the given linked list.">eina_list_prepend</a>(list, d);
     }
</pre></div></p>
<p>After this point, what we have are two distinct lists that share some elements. The first list (inlist) is defined by the pointers inside the elements data structure, while the second list (normal list) has its own node data structure that is kept outside of the elements.</p>
<p>The two lists, sharing some elements, can be represented by the following picture:</p>
 
 <img src="eina_inlist-node_eg2-list-inlist.png" style="max-width: 100%;"/>
   <p>Accessing both lists is done normally, as if they didn't have any elements in common:</p>
<p><div class="fragment"><pre class="fragment">   printf(<span class="stringliteral">&quot;inlist=%p\n&quot;</span>, inlist);
   <a class="code" href="group__Eina__Inline__List__Group.html#ga65e496b9b16d527d23c1d735652b4e62">EINA_INLIST_FOREACH</a>(inlist, cur)
     printf(&quot;\ta=%d, b=%d\n&quot;, cur-&gt;a, cur-&gt;b);

   printf(&quot;list=%p\n&quot;, list);
   <a class="code" href="group__Eina__List__Group.html#gad02f746a08ee0b12b7ed66d4bc0d71d8" title="Definition for the macro to iterate over a list.">EINA_LIST_FOREACH</a>(list, l_itr, cur)
     printf(&quot;\ta=%d, b=%d\n&quot;, cur-&gt;a, cur-&gt;b);

   printf(&quot;inlist count=%d\n&quot;, <a class="code" href="group__Eina__Inline__List__Group.html#ga20d6e4482cda609591cb504c7f0463f5" title="Gets the count of the number of items in a list.">eina_inlist_count</a>(inlist));
   printf(&quot;list count=%d\n\n&quot;, <a class="code" href="group__Eina__List__Group.html#ga301729054a498a2df09a5f1dd760697e" title="Gets the count of the number of items in a list.">eina_list_count</a>(list));
</pre></div></p>
<p>We can remove elements from the normal list, but we just don't free them because they are still stored in the inlist:</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Eina__List__Group.html#ga5b4d2aac696cd2558aaed03e3929d873" title="Definition for the macro to iterate over a list with support for node deletion.">EINA_LIST_FOREACH_SAFE</a>(list, l_itr, l_next, cur)
     {
    <span class="keywordflow">if</span> ((cur-&gt;a % 3) == 0)
      list = <a class="code" href="group__Eina__List__Group.html#ga7edefe0975beecc76c02525fb9200f5a" title="Removes the specified list node.">eina_list_remove_list</a>(list, l_itr);
     }

   printf(<span class="stringliteral">&quot;inlist count=%d\n&quot;</span>, <a class="code" href="group__Eina__Inline__List__Group.html#ga20d6e4482cda609591cb504c7f0463f5" title="Gets the count of the number of items in a list.">eina_inlist_count</a>(inlist));
   printf(<span class="stringliteral">&quot;list count=%d\n\n&quot;</span>, <a class="code" href="group__Eina__List__Group.html#ga301729054a498a2df09a5f1dd760697e" title="Gets the count of the number of items in a list.">eina_list_count</a>(list));
</pre></div></p>
<p>To finish this example, we want to free both lists, we can't just free all elements on the second list (normal list) because they are still being used in the inlist. So we first discard the normal list without freeing its elements, then we free all elements in the inlist (that contains all elements allocated until now):</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Eina__List__Group.html#ga608bd2fbf06293a1b794648990703ab4" title="Frees an entire list and all the nodes, ignoring the data contained.">eina_list_free</a>(list);

   <span class="keywordflow">while</span> (inlist)
     {
        <span class="keyword">struct </span>my_struct *aux = <a class="code" href="group__Eina__Inline__List__Group.html#ga65080f9f858bdbeebc7ea46d17feb180">EINA_INLIST_CONTAINER_GET</a>(inlist,
                                                          <span class="keyword">struct</span> my_struct);
        inlist = <a class="code" href="group__Eina__Inline__List__Group.html#gacb43e626d6c2da5270bc19f713676fe1" title="Removes node from list.">eina_inlist_remove</a>(inlist, inlist);
        free(aux);
     }
</pre></div></p>
<p>Here is the full source code for this example: <a class="el" href="eina_inlist_02_c.html">eina_inlist_02.c Eina_Inlist advanced usage - lists and inlists source</a> </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
