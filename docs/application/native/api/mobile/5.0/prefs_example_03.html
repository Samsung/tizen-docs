<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Prefs Example 03</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('prefs_example_03.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Prefs Example 03 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example shows how to create a prefs widget with Elementary, where some prefs item values are changed, some actions take place on an object different than the prefs widget (an Edge object). With this new object, we're also exemplifying the prefs SWALLOW item type, as the Edje object is put inside the prefs widget's viewport.</p>
<p>It also shows how subpages can be created using the prefs PAGE item type.</p>
<p>Explain step by step the .EDC file is out of scope, the source code can be found at <a class="el" href="prefs_example_03_edc.html">prefs_example_03.edc</a></p>
<h2><a class="anchor" id="prefs-epc-03"></a>
Creating items on EPC file</h2>
<p>First we'll create prefs items on .EPC file that we'll use later on the .C file.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>In the following part, we create an item of the PAGE type, that will create a subpage inside the main page. The source parameter is used to set which page will be used to fill the subpage, in this example, the page named "configpage" will be used.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Now we create a SWALLOW type item, that, as the name suggests, will swallow an Evas_Object.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Now we create the page that will be used to fill the item "config" of the main page. It has another two subpages and a SEPARATOR item arranged horizontally so we could achieve the desired layout.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Then we create the pages used by the "configpage" page, whose items were covered in <a class="el" href="prefs_example_01.html">Prefs Example 01</a> and <a class="el" href="prefs_example_02.html">Prefs Example 02</a>.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<h2><a class="anchor" id="prefs-c-03"></a>
Handling items on C File</h2>
<p>Now we're handling the .C file and first we'll create a layout setting the edje file to after a prefs item swallows it.</p>
<p><div class="fragment"><pre class="fragment">   layout = <a class="code" href="group__Elm__Layout.html#gaca5aee4ad4d92c68f13d1080c70baf8b">elm_layout_add</a>(win);
   <a class="code" href="group__Elm__Layout.html#ga8d1105463d52787a7b0ca8d7402cd3ea">elm_layout_file_set</a>(layout, <span class="stringliteral">&quot;prefs_example_03.edj&quot;</span>, <span class="stringliteral">&quot;prefs_edje&quot;</span>);
</pre></div></p>
<p>Here we create the prefs widget, add smart callbacks and create the prefs data handle.</p>
<p><div class="fragment"><pre class="fragment">   prefs = elm_prefs_add(win);
   evas_object_size_hint_weight_set(prefs, EVAS_HINT_EXPAND, EVAS_HINT_EXPAND);
   evas_object_resize(prefs, WIDTH, HEIGHT);
   <a class="code" href="group__Evas__Object__Group__Basic.html#ga9cbc13661584e49fb9d9cdab514a1eeb">evas_object_show</a>(prefs);

   <a class="code" href="group__Evas__Canvas.html#ga18a8b179f94d21b2b09e19db11741061">evas_object_smart_callback_add</a>(prefs, <span class="stringliteral">&quot;page,loaded&quot;</span>, _page_loaded_cb,
                                  layout);
   <a class="code" href="group__Evas__Canvas.html#ga18a8b179f94d21b2b09e19db11741061">evas_object_smart_callback_add</a>(prefs, <span class="stringliteral">&quot;item,changed&quot;</span>, _item_changed_cb,
                                  layout);

   elm_prefs_autosave_set(prefs, <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>);

   prefs_data =
      elm_prefs_data_new(<span class="stringliteral">&quot;./prefs_example_03.cfg&quot;</span>, NULL, <a class="code" href="group__Eet__File__Group.html#ggaa8e1a7af50fefaf15eb2f69543d24998a763d29c19960a4e0d4eb7bc7bb512481">EET_FILE_MODE_READ_WRITE</a>);

   elm_prefs_file_set(prefs, <span class="stringliteral">&quot;prefs_example_03.epb&quot;</span>, NULL);
   elm_prefs_data_set(prefs, prefs_data);
</pre></div></p>
<p>Now we "swallow" the layout into the SWALLOW item of the prefs widget.</p>
<p><div class="fragment"><pre class="fragment">   elm_prefs_item_swallow(prefs, <span class="stringliteral">&quot;main:swal&quot;</span>, layout);
</pre></div></p>
<p>Page loaded and item changed callbacks will call update functions.</p>
 <div class="fragment"><pre class="fragment">_page_loaded_cb(<span class="keywordtype">void</span> *data, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *obj, <span class="keywordtype">void</span> *event_info EINA_UNUSED)
{
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *layout = data;

   _update(obj, layout);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_item_changed_cb(<span class="keywordtype">void</span> *data, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *obj, <span class="keywordtype">void</span> *event_info)
{
   <span class="keyword">const</span> <span class="keywordtype">char</span> *item = event_info;
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *layout = data;

   <span class="keywordflow">if</span> (!strcmp(item, <span class="stringliteral">&quot;main:config:options:animation_time&quot;</span>))
     _update_animation_time(obj, layout);
   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(item, <span class="stringliteral">&quot;main:config:options:animation&quot;</span>))
     _update_animation(obj, layout);
}
</pre></div></p>
<p>These update functions will be called in order to get the new value from the items and pass it as signal to edje handle it and affects on animation.</p>
 <div class="fragment"><pre class="fragment">_update(<a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *prefs, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *layout)
{
   _update_animation(prefs, layout);
   _update_animation_time(prefs, layout);
}
</pre></div></p>
<p>In this function we'll get the checkbox (bool) value and start or stop the animation on edje.</p>
 <div class="fragment"><pre class="fragment">_update_animation(<a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *prefs, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *layout)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> value;
   <a class="code" href="group__Eina__Types__Group.html#ga3fe0caf72e93b1bab1ca8ee3ccf3f226">Eina_Bool</a> animation;

   elm_prefs_item_value_get(prefs, <span class="stringliteral">&quot;main:config:options:animation&quot;</span>, &amp;value);
   <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(&amp;value, &amp;animation);
   <span class="keywordflow">if</span> (animation)
     <a class="code" href="group__Elm__Layout.html#gaa39b36a49850270dd692ce135b2979f3" title="Send a (Edje) signal to a given layout widget&#39;s underlying Edje object.">elm_layout_signal_emit</a>(layout, <span class="stringliteral">&quot;start&quot;</span>, <span class="stringliteral">&quot;animation&quot;</span>);
   <span class="keywordflow">else</span>
     <a class="code" href="group__Elm__Layout.html#gaa39b36a49850270dd692ce135b2979f3" title="Send a (Edje) signal to a given layout widget&#39;s underlying Edje object.">elm_layout_signal_emit</a>(layout, <span class="stringliteral">&quot;stop&quot;</span>, <span class="stringliteral">&quot;animation&quot;</span>);
}
</pre></div></p>
<p>In this function we'll get the slider (float item) value and send it as animation time to edje.</p>
<p><div class="fragment"><pre class="fragment">_update_animation_time(<a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *prefs, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *layout)
{
   <a class="code" href="struct__Eina__Value.html">Eina_Value</a> value;
   <span class="keywordtype">float</span> animation_time;
   <a class="code" href="struct__Edje__Message__Float.html">Edje_Message_Float</a> msg;

   elm_prefs_item_value_get(prefs, <span class="stringliteral">&quot;main:config:options:animation_time&quot;</span>, &amp;value);
   <a class="code" href="group__Eina__Value__Value__Group.html#ga6f088fe6c6127d808cdf214b355cbdeb" title="Gets the generic value.">eina_value_get</a>(&amp;value, &amp;animation_time);
   <span class="keywordflow">if</span> (animation_time &lt; 0.01) animation_time = 0.01;
   msg.<a class="code" href="struct__Edje__Message__Float.html#a6f297371783ce318fa8d153b634a2b3e">val</a> = animation_time;
   edje_object_message_send(<a class="code" href="group__Elm__Layout.html#gac16e9590a879f644aa5c3bf87c28b03e" title="Get the edje layout.">elm_layout_edje_get</a>(layout), EDJE_MESSAGE_FLOAT,
                            MSG_ID_VEL, &amp;msg);
}
</pre></div></p>
<p>Here we finish the example. The full source code can be found on <a class="el" href="prefs_example_03_c.html">prefs_example_03.c</a>, <a class="el" href="prefs_example_03_epc.html">prefs_example_03.epc</a> and <a class="el" href="prefs_example_03_edc.html">prefs_example_03.edc</a> </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
