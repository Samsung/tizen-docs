<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: YACA Integrity</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__CAPI__YACA__INTEGRITY__MODULE.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">YACA Integrity</div>  </div>
<div class="ingroups"><a class="el" href="group__CAPI__YACA__MODULE.html">YACA</a></div></div><!--header-->
<div class="contents">
<hr/><a name="details" id="details"></a><h2> </h2>
<p>Provides APIs for creating/verifying a signature and digesting a message. </p>
<h2><a class="anchor" id="CAPI_YACA_INTEGRITY_MODULE_HEADER"></a>
Required Header</h2>
<p>#include &lt;yaca/yaca_sign.h&gt;<br/>
 #include &lt;yaca/yaca_digest.h&gt;<br/>
</p>
<h2><a class="anchor" id="CAPI_YACA_INTEGRITY_MODULE_OVERVIEW"></a>
Overview</h2>
<p>It provides advanced APIs for creating a signature using asymmetric private key, verifying a signature using asymmetric public key, calculating a HMAC/CMAC of given message using symmetric key and calculating message digests of given message without key.</p>
<h2><a class="anchor" id="CAPI_YACA_INTEGRITY_MODULE_EXAMPLES"></a>
Examples</h2>
<p>Message Digest API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_digest.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402" title="The context handle.">yaca_context_h</a> ctx = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab66ba7b76f981f054739dae9dd60cb98" title="NULL value for the crypto context.">YACA_CONTEXT_NULL</a>;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    printf(<span class="stringliteral">&quot;Plain data (16 of %zu bytes): %.16s\n&quot;</span>, INPUT_DATA_SIZE, INPUT_DATA);

    <span class="comment">/* Initialize digest context */</span>
    ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d" title="Initializes a digest context.">yaca_digest_initialize</a>(&amp;ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa55f07837a469ead26de3cd527a8d7d20">YACA_DIGEST_SHA256</a>);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Feeds the message */</span>
    ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4" title="Feeds the message into the message digest algorithm.">yaca_digest_update</a>(ctx, INPUT_DATA, INPUT_DATA_SIZE);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Get digest length */</span>
    <span class="keywordtype">size_t</span> digest_len;
    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length</a>(ctx, 0, &amp;digest_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Calculate digest */</span>
    {
        <span class="keywordtype">char</span> digest[digest_len];
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948" title="Calculates the final digest.">yaca_digest_finalize</a>(ctx, digest, &amp;digest_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* display digest in hexadecimal format */</span>
        dump_hex(digest, digest_len, <span class="stringliteral">&quot;Message digest: &quot;</span>);
    }

exit:
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy</a>(ctx);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Signature API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_sign.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402" title="The context handle.">yaca_context_h</a> ctx = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab66ba7b76f981f054739dae9dd60cb98" title="NULL value for the crypto context.">YACA_CONTEXT_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> priv_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> pub_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga3bb8ab5874736fbc905001b0f9b3322e" title="Enumeration of YACA paddings.">yaca_padding_e</a> padding = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3bb8ab5874736fbc905001b0f9b3322ea382eeca16d0f26e7f17bc9e74f1919f6">YACA_PADDING_PKCS1_PSS</a>;

    <span class="keywordtype">char</span> *signature = NULL;
    <span class="keywordtype">size_t</span> signature_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Generate key pair */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa49c9fbb5f7d3c0184813a717467b5ed8">YACA_KEY_LENGTH_2048BIT</a>, &amp;priv_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080" title="Extracts public key from a private one.">yaca_key_extract_public</a>(priv_key, &amp;pub_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Sign */</span>
    {
        <span class="comment">/* Initialize sign context */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02" title="Initializes a signature context for asymmetric signatures.">yaca_sign_initialize</a>(&amp;ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa55f07837a469ead26de3cd527a8d7d20">YACA_DIGEST_SHA256</a>, priv_key);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Set padding method */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property</a>(ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa1700ae68bc0622a63aaa347af1568cea27ed954622bc0ea5c77f8f721598d891">YACA_PROPERTY_PADDING</a>, &amp;padding, <span class="keyword">sizeof</span>(padding));
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Feeds the message */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update</a>(ctx, INPUT_DATA, INPUT_DATA_SIZE);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Get signature length and allocate memory */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length</a>(ctx, 0, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae7e7174b1a32f170de411d92e46c799f" title="Allocates the memory.">yaca_malloc</a>(signature_len, (<span class="keywordtype">void</span>**)&amp;signature);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Calculate signature */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize</a>(ctx, signature, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* display signature in hexadecimal format */</span>
        dump_hex(signature, signature_len, <span class="stringliteral">&quot;Signature of INPUT_DATA:&quot;</span>);

        <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy</a>(ctx);
        ctx = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab66ba7b76f981f054739dae9dd60cb98" title="NULL value for the crypto context.">YACA_CONTEXT_NULL</a>;
    }

    <span class="comment">/* Verify */</span>
    {
        <span class="comment">/* Initialize verify context */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize</a>(&amp;ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa55f07837a469ead26de3cd527a8d7d20">YACA_DIGEST_SHA256</a>, pub_key);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Set padding method */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property</a>(ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa1700ae68bc0622a63aaa347af1568cea27ed954622bc0ea5c77f8f721598d891">YACA_PROPERTY_PADDING</a>, &amp;padding, <span class="keyword">sizeof</span>(padding));
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Feeds the message */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update</a>(ctx, INPUT_DATA, INPUT_DATA_SIZE);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Verify signature */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize</a>(ctx, signature, signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>) {
            printf(<span class="stringliteral">&quot;Verification failed\n&quot;</span>);
            <span class="keywordflow">goto</span> exit;
        } <span class="keywordflow">else</span> {
            printf(<span class="stringliteral">&quot;Verification successful\n&quot;</span>);
        }
    }

exit:
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(signature);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(priv_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(pub_key);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy</a>(ctx);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> HMAC Signature API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_sign.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402" title="The context handle.">yaca_context_h</a> ctx = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab66ba7b76f981f054739dae9dd60cb98" title="NULL value for the crypto context.">YACA_CONTEXT_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> sym_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    <span class="keywordtype">char</span> *signature1 = NULL;
    <span class="keywordtype">char</span> *signature2 = NULL;
    <span class="keywordtype">size_t</span> signature_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Key generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>, &amp;sym_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Sign */</span>
    {
        <span class="comment">/* Initialize sign context */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673" title="Initializes a signature context for HMAC.">yaca_sign_initialize_hmac</a>(&amp;ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa6179afafe4e0ddee42e0be05fa027a15">YACA_DIGEST_SHA512</a>, sym_key);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Feeds the message */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update</a>(ctx, INPUT_DATA, INPUT_DATA_SIZE);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Get signature length and allocate memory */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length</a>(ctx, 0, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae7e7174b1a32f170de411d92e46c799f" title="Allocates the memory.">yaca_malloc</a>(signature_len, (<span class="keywordtype">void</span>**)&amp;signature1);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Calculate signature */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize</a>(ctx, signature1, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* display signature in hexadecimal format */</span>
        dump_hex(signature1, signature_len, <span class="stringliteral">&quot;HMAC Signature of INPUT_DATA:&quot;</span>);

        <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy</a>(ctx);
        ctx = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab66ba7b76f981f054739dae9dd60cb98" title="NULL value for the crypto context.">YACA_CONTEXT_NULL</a>;
    }

    <span class="comment">/* Verify */</span>
    {
        <span class="comment">/* Initialize sign context */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673" title="Initializes a signature context for HMAC.">yaca_sign_initialize_hmac</a>(&amp;ctx, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa6179afafe4e0ddee42e0be05fa027a15">YACA_DIGEST_SHA512</a>, sym_key);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Feeds the message */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update</a>(ctx, INPUT_DATA, INPUT_DATA_SIZE);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Get signature length and allocate memory */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length</a>(ctx, 0, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae7e7174b1a32f170de411d92e46c799f" title="Allocates the memory.">yaca_malloc</a>(signature_len, (<span class="keywordtype">void</span>**)&amp;signature2);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Calculate signature */</span>
        ret = <a class="code" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize</a>(ctx, signature2, &amp;signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* Verify signature */</span>
        ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae4629e1a3e408e35113dc1a25eaff6d1" title="Safely compares first len bytes of two buffers.">yaca_memcmp</a>(signature1, signature2, signature_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>) {
            printf(<span class="stringliteral">&quot;Verification failed\n&quot;</span>);
            <span class="keywordflow">goto</span> exit;
        } <span class="keywordflow">else</span> {
            printf(<span class="stringliteral">&quot;Verification successful\n&quot;</span>);
        }
    }

exit:
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(signature1);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(signature2);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(sym_key);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy</a>(ctx);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d">yaca_digest_initialize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *ctx, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a digest context.  <a href="#ga7c30cbdecf33b3e2355de99f661a950d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4">yaca_digest_update</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, const char *message, size_t message_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Feeds the message into the message digest algorithm.  <a href="#ga9d44c2f5b2b661509b0e86490e2b85d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948">yaca_digest_finalize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, char *digest, size_t *digest_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the final digest.  <a href="#ga038df54e05a73537ac75e10e2d809948"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02">yaca_sign_initialize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *ctx, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo, const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> prv_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a signature context for asymmetric signatures.  <a href="#gaf265cdbdac2523788413d66ff41acc02"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673">yaca_sign_initialize_hmac</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *ctx, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo, const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> sym_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a signature context for HMAC.  <a href="#ga2ee92601f4ce1edc9f900f4e3f489673"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga66399705056a0075320f75634ec4361b">yaca_sign_initialize_cmac</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *ctx, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga5122956710d079a094631af35bae8ea9">yaca_encrypt_algorithm_e</a> algo, const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> sym_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a signature context for CMAC.  <a href="#ga66399705056a0075320f75634ec4361b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad">yaca_sign_update</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, const char *message, size_t message_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Feeds the message into the digital signature or MAC algorithm.  <a href="#ga336945487c30be56015d051a8e723cad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f">yaca_sign_finalize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, char *signature, size_t *signature_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the final signature or MAC.  <a href="#gaf0543496a588b170d6a158b90be7b80f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87">yaca_verify_initialize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *ctx, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo, const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> pub_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a signature verification context for asymmetric signatures.  <a href="#ga7aa05f70ff77eece15a3a990ce77be87"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c">yaca_verify_update</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, const char *message, size_t message_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Feeds the message into the digital signature verification algorithm.  <a href="#ga2ed2907dd32cad8e48c9bb563ed6b84c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827">yaca_verify_finalize</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> ctx, const char *signature, size_t signature_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the verification.  <a href="#ga899df2b930bb612fc33685c989a9a827"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga038df54e05a73537ac75e10e2d809948"></a><!-- doxytag: member="yaca_digest.h::yaca_digest_finalize" ref="ga038df54e05a73537ac75e10e2d809948" args="(yaca_context_h ctx, char *digest, size_t *digest_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948">yaca_digest_finalize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>digest_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the final digest. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Skipping <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4" title="Feeds the message into the message digest algorithm.">yaca_digest_update()</a> and calling only <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948" title="Calculates the final digest.">yaca_digest_finalize()</a> will produce an empty message digest.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>A valid digest context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">digest</td><td>Buffer for the message digest (must be allocated by client, see <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">digest_len</td><td>Length of the digest, actual number of bytes written will be returned here</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d" title="Initializes a digest context.">yaca_digest_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4" title="Feeds the message into the message digest algorithm.">yaca_digest_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga7c30cbdecf33b3e2355de99f661a950d"></a><!-- doxytag: member="yaca_digest.h::yaca_digest_initialize" ref="ga7c30cbdecf33b3e2355de99f661a950d" args="(yaca_context_h *ctx, yaca_digest_algorithm_e algo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d">yaca_digest_initialize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a digest context. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>ctx</em> should be released using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctx</td><td>Newly created context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that will be used</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>algo</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4" title="Feeds the message into the message digest algorithm.">yaca_digest_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948" title="Calculates the final digest.">yaca_digest_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga9d44c2f5b2b661509b0e86490e2b85d4"></a><!-- doxytag: member="yaca_digest.h::yaca_digest_update" ref="ga9d44c2f5b2b661509b0e86490e2b85d4" args="(yaca_context_h ctx, const char *message, size_t message_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga9d44c2f5b2b661509b0e86490e2b85d4">yaca_digest_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Feeds the message into the message digest algorithm. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>Context created by <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d" title="Initializes a digest context.">yaca_digest_initialize()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Message from which the digest is to be calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_len</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7c30cbdecf33b3e2355de99f661a950d" title="Initializes a digest context.">yaca_digest_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga038df54e05a73537ac75e10e2d809948" title="Calculates the final digest.">yaca_digest_finalize()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaf0543496a588b170d6a158b90be7b80f"></a><!-- doxytag: member="yaca_sign.h::yaca_sign_finalize" ref="gaf0543496a588b170d6a158b90be7b80f" args="(yaca_context_h ctx, char *signature, size_t *signature_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f">yaca_sign_finalize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>signature_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the final signature or MAC. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Skipping <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update()</a> and calling only <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> will produce a signature or MAC of an empty message.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>A valid sign context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signature</td><td>Buffer for the MAC or the message signature (must be allocated by client, see <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">signature_len</td><td>Length of the MAC or the signature, actual number of bytes written will be returned here</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02" title="Initializes a signature context for asymmetric signatures.">yaca_sign_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673" title="Initializes a signature context for HMAC.">yaca_sign_initialize_hmac()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga66399705056a0075320f75634ec4361b" title="Initializes a signature context for CMAC.">yaca_sign_initialize_cmac()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa4cf587a86049a0be9f5bc6719a01d75" title="Returns the minimum required size of the output buffer for a single crypto function call...">yaca_context_get_output_length()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaf265cdbdac2523788413d66ff41acc02"></a><!-- doxytag: member="yaca_sign.h::yaca_sign_initialize" ref="gaf265cdbdac2523788413d66ff41acc02" args="(yaca_context_h *ctx, yaca_digest_algorithm_e algo, const yaca_key_h prv_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02">yaca_sign_initialize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>prv_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a signature context for asymmetric signatures. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For verification use <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize()</a>, <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update()</a> and <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize()</a> functions with matching public key.</dd>
<dd>
For RSA operations the default padding used is <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3bb8ab5874736fbc905001b0f9b3322ea1a55bff547f93f4cbdf7bc416020310a">YACA_PADDING_PKCS1</a>. It can be changed using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property()</a> with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa1700ae68bc0622a63aaa347af1568cea27ed954622bc0ea5c77f8f721598d891">YACA_PROPERTY_PADDING</a>.</dd>
<dd>
For <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaae2d98eb565be729118f6437e48fc32a1">YACA_DIGEST_SHA384</a> and <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa6179afafe4e0ddee42e0be05fa027a15">YACA_DIGEST_SHA512</a> the RSA key size must be bigger than <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa9aced47318bf1abe65d25faa04a6bea0">YACA_KEY_LENGTH_512BIT</a>.</dd>
<dd>
Using of <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa1222b9a80c44ba159099101f80422b31">YACA_DIGEST_MD5</a> algorithm for DSA and ECDSA operations is prohibited.</dd>
<dd>
Using of <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa1222b9a80c44ba159099101f80422b31">YACA_DIGEST_MD5</a> or <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa8e8da418fc6f7dfd273e6efd46c5ae51">YACA_DIGEST_SHA224</a> with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3bb8ab5874736fbc905001b0f9b3322ea9e03209c721ea8ce18dbcafdc862edcf">YACA_PADDING_X931</a> is prohibited.</dd>
<dd>
The <em>ctx</em> should be released using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctx</td><td>Newly created context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prv_key</td><td>Private key that will be used, algorithm is deduced based on key type, supported key types:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8ab8fe021fe9b57c335bffe4d9f9c6f734">YACA_KEY_TYPE_DSA_PRIV</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8abc222a3c14b6a7b9e56de795728a413c">YACA_KEY_TYPE_EC_PRIV</a></li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>algo</em> or <em>prv_key</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga3bb8ab5874736fbc905001b0f9b3322e" title="Enumeration of YACA paddings.">yaca_padding_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga66399705056a0075320f75634ec4361b"></a><!-- doxytag: member="yaca_sign.h::yaca_sign_initialize_cmac" ref="ga66399705056a0075320f75634ec4361b" args="(yaca_context_h *ctx, yaca_encrypt_algorithm_e algo, const yaca_key_h sym_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga66399705056a0075320f75634ec4361b">yaca_sign_initialize_cmac</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga5122956710d079a094631af35bae8ea9">yaca_encrypt_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>sym_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a signature context for CMAC. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For verification, calculate message CMAC and compare with received MAC using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae4629e1a3e408e35113dc1a25eaff6d1" title="Safely compares first len bytes of two buffers.">yaca_memcmp()</a>.</dd>
<dd>
The <em>ctx</em> should be released using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctx</td><td>Newly created context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Encryption algorithm that will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sym_key</td><td>Symmetric key that will be used, supported key types:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a3a3846a1fc5253d7dcba7b762f3a01ff">YACA_KEY_TYPE_DES</a></li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>algo</em> or <em>sym_key</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga5122956710d079a094631af35bae8ea9" title="Enumeration of YACA symmetric encryption algorithms.">yaca_encrypt_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae4629e1a3e408e35113dc1a25eaff6d1" title="Safely compares first len bytes of two buffers.">yaca_memcmp()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga2ee92601f4ce1edc9f900f4e3f489673"></a><!-- doxytag: member="yaca_sign.h::yaca_sign_initialize_hmac" ref="ga2ee92601f4ce1edc9f900f4e3f489673" args="(yaca_context_h *ctx, yaca_digest_algorithm_e algo, const yaca_key_h sym_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673">yaca_sign_initialize_hmac</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>sym_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a signature context for HMAC. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For verification, calculate message HMAC and compare with received MAC using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae4629e1a3e408e35113dc1a25eaff6d1" title="Safely compares first len bytes of two buffers.">yaca_memcmp()</a>.</dd>
<dd>
The <em>ctx</em> should be released using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctx</td><td>Newly created context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sym_key</td><td>Symmetric key that will be used, supported key types:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a3a3846a1fc5253d7dcba7b762f3a01ff">YACA_KEY_TYPE_DES</a></li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>algo</em> or <em>sym_key</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad" title="Feeds the message into the digital signature or MAC algorithm.">yaca_sign_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae4629e1a3e408e35113dc1a25eaff6d1" title="Safely compares first len bytes of two buffers.">yaca_memcmp()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga336945487c30be56015d051a8e723cad"></a><!-- doxytag: member="yaca_sign.h::yaca_sign_update" ref="ga336945487c30be56015d051a8e723cad" args="(yaca_context_h ctx, const char *message, size_t message_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga336945487c30be56015d051a8e723cad">yaca_sign_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Feeds the message into the digital signature or MAC algorithm. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>Context created by <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02" title="Initializes a signature context for asymmetric signatures.">yaca_sign_initialize()</a>, <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673" title="Initializes a signature context for HMAC.">yaca_sign_initialize_hmac()</a> or <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga66399705056a0075320f75634ec4361b" title="Initializes a signature context for CMAC.">yaca_sign_initialize_cmac()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Message to be signed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_len</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf265cdbdac2523788413d66ff41acc02" title="Initializes a signature context for asymmetric signatures.">yaca_sign_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ee92601f4ce1edc9f900f4e3f489673" title="Initializes a signature context for HMAC.">yaca_sign_initialize_hmac()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga66399705056a0075320f75634ec4361b" title="Initializes a signature context for CMAC.">yaca_sign_initialize_cmac()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga899df2b930bb612fc33685c989a9a827"></a><!-- doxytag: member="yaca_sign.h::yaca_verify_finalize" ref="ga899df2b930bb612fc33685c989a9a827" args="(yaca_context_h ctx, const char *signature, size_t signature_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827">yaca_verify_finalize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>signature_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the verification. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Skipping <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update()</a> and calling only <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize()</a> will verify the signature of an empty message.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>A valid verify context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>Message signature to be verified </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature_len</td><td>Length of the signature</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a78dc5ec496282e6bdcd832bcc086c048">YACA_ERROR_DATA_MISMATCH</a></td><td>The verification failed</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#gaf0543496a588b170d6a158b90be7b80f" title="Calculates the final signature or MAC.">yaca_sign_finalize()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga7aa05f70ff77eece15a3a990ce77be87"></a><!-- doxytag: member="yaca_sign.h::yaca_verify_initialize" ref="ga7aa05f70ff77eece15a3a990ce77be87" args="(yaca_context_h *ctx, yaca_digest_algorithm_e algo, const yaca_key_h pub_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87">yaca_verify_initialize</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>pub_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes a signature verification context for asymmetric signatures. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>For RSA operations the default padding used is <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3bb8ab5874736fbc905001b0f9b3322ea1a55bff547f93f4cbdf7bc416020310a">YACA_PADDING_PKCS1</a>. It can be changed using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property()</a> with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa1700ae68bc0622a63aaa347af1568cea27ed954622bc0ea5c77f8f721598d891">YACA_PROPERTY_PADDING</a>. For verify to succeed it has to be set to the same value it was signed with.</dd>
<dd>
The <em>ctx</em> should be released using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ctx</td><td>Newly created context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that will be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pub_key</td><td>Public key that will be used, algorithm is deduced based on key type, supported key types:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8af507c1122a5dab50a29afdafa28847e8">YACA_KEY_TYPE_RSA_PUB</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a4461b4e3fce1e2adc1e64636ee65f2b1">YACA_KEY_TYPE_DSA_PUB</a>,</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a8436a53eea717bc7ac9eece995c7d47b">YACA_KEY_TYPE_EC_PUB</a></li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, invalid <em>algo</em> or <em>pub_key</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga3bb8ab5874736fbc905001b0f9b3322e" title="Enumeration of YACA paddings.">yaca_padding_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga733c030ee9c2b4df0567beeba61902d2" title="Sets the non-standard context properties. Can only be called on an initialized context.">yaca_context_set_property()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c" title="Feeds the message into the digital signature verification algorithm.">yaca_verify_update()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaab125aee2a8a830d6249be65293eb1ba" title="Destroys the crypto context. Must be called on all contexts that are no longer used. Passing YACA_CONTEXT_NULL is allowed.">yaca_context_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga2ed2907dd32cad8e48c9bb563ed6b84c"></a><!-- doxytag: member="yaca_sign.h::yaca_verify_update" ref="ga2ed2907dd32cad8e48c9bb563ed6b84c" args="(yaca_context_h ctx, const char *message, size_t message_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga2ed2907dd32cad8e48c9bb563ed6b84c">yaca_verify_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae768a784cd586d05e4578712c03f1402">yaca_context_h</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>message_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Feeds the message into the digital signature verification algorithm. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>Context created by <a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_len</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>ctx</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga7aa05f70ff77eece15a3a990ce77be87" title="Initializes a signature verification context for asymmetric signatures.">yaca_verify_initialize()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__INTEGRITY__MODULE.html#ga899df2b930bb612fc33685c989a9a827" title="Performs the verification.">yaca_verify_finalize()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
