<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: eina_model_01.c</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">4.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('eina_model_01_8c-example.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">eina_model_01.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><span class="comment">/*</span>
<span class="comment"> * Compile with:</span>
<span class="comment"> * gcc -o eina_model_01 eina_model_01.c `pkg-config --cflags --libs eina`</span>
<span class="comment"> */</span>

<span class="comment">/*</span>
<span class="comment"> * This example demonstrates the usage of Eina Model by implementing</span>
<span class="comment"> * Bank Account Class, which is inherited from Base Class;</span>
<span class="comment"> * and Credit Card Class, which is inherited from Bank Account Class.</span>
<span class="comment"> *</span>
<span class="comment"> * Base Class(Eina_Model_Type) --&gt; Bank Account Class --&gt; Credit Card Class</span>
<span class="comment"> *</span>
<span class="comment"> * Bank Account Class implements &quot;bank_account_data_set()&quot; and &quot;print()&quot; methods;</span>
<span class="comment"> * Credit Card Class inherits these two and implements &quot;credit_card_data_set()&quot;</span>
<span class="comment"> *</span>
<span class="comment"> *</span>
<span class="comment"> *  Bank Account Class::print() calls for &quot;_bank_account_data_print&quot;</span>
<span class="comment"> *  Credit Card Class ::print() is reloaded with &quot;_credit_card_data_print()&quot;</span>
<span class="comment"> *  which calls for parent function &quot;_bank_account_data_print&quot;</span>
<span class="comment"> *</span>
<span class="comment"> */</span>


<span class="preprocessor">#include &lt;Eina.h&gt;</span>
<span class="preprocessor">#include &lt;eina_safety_checks.h&gt;</span>

<span class="comment">/*</span>
<span class="comment"> * Defining type for new model type</span>
<span class="comment"> * Model will have two methods</span>
<span class="comment"> */</span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>_Bank_Account_Type
{
   Eina_Model_Type parent_class;
   void (*bank_account_data_set)(Eina_Model *, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *number);
   void (*print)(Eina_Model *);
} Bank_Account_Type;

<span class="comment">/*</span>
<span class="comment"> * Defining type for Bank Account private data</span>
<span class="comment"> */</span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>_Bank_Account_Data
{
   <span class="keywordtype">char</span> name[30];
   <span class="keywordtype">char</span> number[30];
} Bank_Account_Data;

<span class="comment">/*</span>
<span class="comment"> * Defining type for Credit Card model type, which will be inherited from Bank Account model type</span>
<span class="comment"> * Model will have two parent&#39;s methods and additional one</span>
<span class="comment"> */</span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>_Credit_Card_Type
{
   Bank_Account_Type parent_class;
   void (*credit_card_data_set)(Eina_Model *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, int) ;
} Credit_Card_Type;

<span class="comment">/*</span>
<span class="comment"> * Defining type for Credit Card private data</span>
<span class="comment"> */</span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>_Credit_Card_Data
{
   <span class="keywordtype">char</span> number[30];
   <span class="keywordtype">char</span> expiry_date[30];
   <span class="keywordtype">int</span> pin;
} Credit_Card_Data;

<span class="keyword">static</span> Bank_Account_Type _BANK_ACCOUNT_TYPE;
<span class="keyword">static</span> Credit_Card_Type _CREDIT_CARD_TYPE;
<span class="keyword">static</span> Eina_Model_Type *BANK_ACCOUNT_TYPE = (Eina_Model_Type *) &amp;_BANK_ACCOUNT_TYPE;
<span class="keyword">static</span> Eina_Model_Type *CREDIT_CARD_TYPE = (Eina_Model_Type *) &amp;_CREDIT_CARD_TYPE;


<span class="comment">/*</span>
<span class="comment"> * Defining method for for Bank Account data</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span>
_bank_account_data_set(Eina_Model *mdl, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *number)
{
   Bank_Account_Data *bdata = eina_model_type_private_data_get(mdl, BANK_ACCOUNT_TYPE);

   <span class="keywordflow">if</span> (!bdata)
      printf(<span class="stringliteral">&quot;ERROR\n&quot;</span>);

   <span class="keywordflow">if</span> (name != NULL)
     {
        strncpy(bdata-&gt;name, name, <span class="keyword">sizeof</span>(bdata-&gt;name));
        bdata-&gt;name[<span class="keyword">sizeof</span>(bdata-&gt;number) - 1] = <span class="charliteral">&#39;\0&#39;</span>;
     }

   <span class="keywordflow">if</span> (number != NULL)
     {
        strncpy(bdata-&gt;number, number, <span class="keyword">sizeof</span>(bdata-&gt;number));
        bdata-&gt;number[<span class="keyword">sizeof</span>(bdata-&gt;number) - 1] = <span class="charliteral">&#39;\0&#39;</span>;
     }

   printf(<span class="stringliteral">&quot;%s :: %s %p\n&quot;</span>, eina_model_type_name_get(eina_model_type_get(mdl)) ,__func__, mdl);
}


<span class="keyword">static</span> <span class="keywordtype">void</span>
_credit_card_data_set(Eina_Model *mdl, <span class="keyword">const</span> <span class="keywordtype">char</span> *number, <span class="keyword">const</span> <span class="keywordtype">char</span> *expiry_date, <span class="keywordtype">int</span> pin)
{
   Credit_Card_Data *cdata = eina_model_type_private_data_get(mdl, CREDIT_CARD_TYPE);

   <span class="keywordflow">if</span> (!cdata)
      printf(<span class="stringliteral">&quot;ERROR\n&quot;</span>);

   <span class="keywordflow">if</span> (number != NULL)
     {
        strncpy(cdata-&gt;number, number, <span class="keyword">sizeof</span>(cdata-&gt;number));
        cdata-&gt;number[<span class="keyword">sizeof</span>(cdata-&gt;number) - 1] = <span class="charliteral">&#39;\0&#39;</span>;
     }

   <span class="keywordflow">if</span> (expiry_date != NULL)
     {
        strncpy(cdata-&gt;expiry_date, expiry_date, <span class="keyword">sizeof</span>(cdata-&gt;expiry_date));
        cdata-&gt;expiry_date[<span class="keyword">sizeof</span>(cdata-&gt;expiry_date) - 1] = <span class="charliteral">&#39;\0&#39;</span>;
     }

   cdata-&gt;pin = pin;
   printf(<span class="stringliteral">&quot;%s :: %s %p\n&quot;</span>, eina_model_type_name_get(eina_model_type_get(mdl)) ,__func__, mdl);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_bank_account_data_print(Eina_Model *mdl)
{
   <span class="keyword">const</span> Bank_Account_Data *bdata = eina_model_type_private_data_get(mdl, BANK_ACCOUNT_TYPE);

   printf(<span class="stringliteral">&quot;\n%s :: %s %p \n\tName: %s(%p)\n\tAccount: %s(%p)\n&quot;</span>, eina_model_type_name_get(eina_model_type_get(mdl)) ,__func__, mdl
         , bdata-&gt;name, bdata-&gt;name, bdata-&gt;number, bdata-&gt;number);
}

<span class="keyword">static</span> <span class="keywordtype">void</span>
_credit_card_data_print(Eina_Model *mdl)
{
   void (*pf)(Eina_Model *);
   <span class="keyword">const</span> Eina_Model_Type *ptype = eina_model_type_parent_get(eina_model_type_get(mdl));
   <span class="comment">//const Eina_Model_Type *ptype = eina_model_type_get(mdl);</span>

   pf = eina_model_type_method_resolve(ptype, mdl, Bank_Account_Type, print);
   <span class="keywordflow">if</span> (pf)
      pf(mdl);
   <span class="keywordflow">else</span>
      printf(<span class="stringliteral">&quot;ERROR: %d&quot;</span>, __LINE__);
   <span class="keyword">const</span> Credit_Card_Data *cdata = eina_model_type_private_data_get(mdl, CREDIT_CARD_TYPE);
   printf(<span class="stringliteral">&quot;%s :: %s %p \n\tNumber: %s(%p)\n\tCC Expiry Date: %s(%p)\n\tCC PIN: %d(%p)\n&quot;</span>, eina_model_type_name_get(eina_model_type_get(mdl)) ,__func__, mdl
         , cdata-&gt;number, cdata-&gt;number, cdata-&gt;expiry_date, cdata-&gt;expiry_date, cdata-&gt;pin, &amp;cdata-&gt;pin);
}

<span class="preprocessor">#define BANK_ACCOUNT(x) ((Bank_Account_Type *) x)</span>
<span class="preprocessor"></span><span class="preprocessor">#define CREDIT_CARD(x) ((Credit_Card_Type *) x)</span>
<span class="preprocessor"></span>
<span class="keywordtype">void</span>
bank_account_data_set(Eina_Model *mdl, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">char</span> *number)
{

   <a name="a0"></a><a class="code" href="group__Eina__Safety__Checks__Group.html#ga4c65e34fc0099bb68833d44ad02fb724" title="The macro doesn&#39;t do anything unless EINA_SAFETY_CHECKS is defined.">EINA_SAFETY_ON_FALSE_RETURN</a>(eina_model_instance_check(mdl, BANK_ACCOUNT_TYPE));

   void (*pf)(Eina_Model *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
   pf = eina_model_method_resolve(mdl, Bank_Account_Type, bank_account_data_set);
   <span class="keywordflow">if</span> (pf)
      pf(mdl, name, number);
   <span class="keywordflow">else</span>
      printf(<span class="stringliteral">&quot;ERROR %d\n&quot;</span>, __LINE__);
}

<span class="keywordtype">void</span>
data_print(Eina_Model *mdl)
{
   <a class="code" href="group__Eina__Safety__Checks__Group.html#ga4c65e34fc0099bb68833d44ad02fb724" title="The macro doesn&#39;t do anything unless EINA_SAFETY_CHECKS is defined.">EINA_SAFETY_ON_FALSE_RETURN</a>(eina_model_instance_check(mdl, BANK_ACCOUNT_TYPE));

   void (*pf)(Eina_Model *);
   pf = eina_model_method_resolve(mdl, Bank_Account_Type, print);
   <span class="keywordflow">if</span> (pf)
      pf(mdl);
   <span class="keywordflow">else</span>
      printf(<span class="stringliteral">&quot;ERROR %d\n&quot;</span>, __LINE__);
}

<span class="keywordtype">void</span>
credit_card_data_set(Eina_Model *mdl, <span class="keyword">const</span> <span class="keywordtype">char</span> *number, <span class="keyword">const</span> <span class="keywordtype">char</span> *expiry_date, <span class="keywordtype">int</span> pin)
{
   <a class="code" href="group__Eina__Safety__Checks__Group.html#ga4c65e34fc0099bb68833d44ad02fb724" title="The macro doesn&#39;t do anything unless EINA_SAFETY_CHECKS is defined.">EINA_SAFETY_ON_FALSE_RETURN</a>(eina_model_instance_check(mdl, CREDIT_CARD_TYPE));

   void (*pf)(Eina_Model *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, int);
   pf = eina_model_method_resolve(mdl, Credit_Card_Type, credit_card_data_set);
   <span class="keywordflow">if</span> (pf)
      pf(mdl, number, expiry_date, pin);
   <span class="keywordflow">else</span>
      printf(<span class="stringliteral">&quot;ERROR %d\n&quot;</span>, __LINE__);
}

<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
   Eina_Model *b, *cc;

   <a name="a1"></a><a class="code" href="group__Eina__Main__Group.html#gafee4bfc0e509b6ffed6598edf6f4b3de" title="Initializes the Eina library.">eina_init</a>();

   memset(&amp;_BANK_ACCOUNT_TYPE, 0, <span class="keyword">sizeof</span>(_BANK_ACCOUNT_TYPE));
   memset(&amp;_CREDIT_CARD_TYPE, 0, <span class="keyword">sizeof</span>(_CREDIT_CARD_TYPE));

   BANK_ACCOUNT_TYPE-&gt;version = EINA_MODEL_TYPE_VERSION;
   BANK_ACCOUNT_TYPE-&gt;type_size = <span class="keyword">sizeof</span>(Bank_Account_Type);
   BANK_ACCOUNT_TYPE-&gt;private_size = <span class="keyword">sizeof</span>(Bank_Account_Data);
   BANK_ACCOUNT_TYPE-&gt;name = <span class="stringliteral">&quot;Bank_Account_Model&quot;</span>;
   BANK_ACCOUNT_TYPE-&gt;parent = EINA_MODEL_TYPE_GENERIC;
   BANK_ACCOUNT(BANK_ACCOUNT_TYPE)-&gt;bank_account_data_set = _bank_account_data_set;
   BANK_ACCOUNT(BANK_ACCOUNT_TYPE)-&gt;print = _bank_account_data_print;

   CREDIT_CARD_TYPE-&gt;version = EINA_MODEL_TYPE_VERSION;
   CREDIT_CARD_TYPE-&gt;type_size = <span class="keyword">sizeof</span>(Credit_Card_Type);
   CREDIT_CARD_TYPE-&gt;private_size = <span class="keyword">sizeof</span>(Credit_Card_Data);
   CREDIT_CARD_TYPE-&gt;name = <span class="stringliteral">&quot;Credit_Card_Model&quot;</span>;
   CREDIT_CARD_TYPE-&gt;parent = BANK_ACCOUNT_TYPE;
   CREDIT_CARD(CREDIT_CARD_TYPE)-&gt;credit_card_data_set = _credit_card_data_set;
   BANK_ACCOUNT(CREDIT_CARD_TYPE)-&gt;print = _credit_card_data_print;

   b = eina_model_new(BANK_ACCOUNT_TYPE);   <span class="comment">//creating object of bank class</span>
   cc = eina_model_new(CREDIT_CARD_TYPE);   <span class="comment">//creating object of credit card class</span>

   bank_account_data_set(b, <span class="stringliteral">&quot;Bill Clark&quot;</span>, <span class="stringliteral">&quot;8569214756&quot;</span>);
   bank_account_data_set(cc, <span class="stringliteral">&quot;John Smith&quot;</span>, <span class="stringliteral">&quot;3154789&quot;</span>);

   credit_card_data_set(cc, <span class="stringliteral">&quot;5803 6589 4786 3279 9173&quot;</span>, <span class="stringliteral">&quot;01/01/2015&quot;</span>, 1234);

   data_print(b);
   data_print(cc);

   eina_model_unref(b);
   eina_model_unref(cc);

   <a name="a2"></a><a class="code" href="group__Eina__Main__Group.html#ga2c8b4020427108a30c44707af22c99d3" title="Shuts down the Eina library.">eina_shutdown</a>();

   <span class="keywordflow">return</span> 0;
}
</pre></div> </div><!-- contents -->
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
