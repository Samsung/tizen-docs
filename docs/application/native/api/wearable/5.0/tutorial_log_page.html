<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Log Tutorial</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tutorial_log_page.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Log Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="tutorial_log_introduction"></a>
Introduction</h2>
<p>The Eina Log module provides logging facilities for libraries and applications. It provides colored logging, basic logging levels (error, warning, debug, info, critical) and loggers - called logging domains - which will be covered in next sections.</p>
<h2><a class="anchor" id="tutorial_log_basic_usage"></a>
Basic Usage</h2>
<p>Log messages can be displayed using the following macros:</p>
<ul>
<li><a class="el" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b">EINA_LOG_ERR()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#ga21c44f66537533db16ee8f475ae2ae70">EINA_LOG_WARN()</a>, </li>
<li><a class="el" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG()</a>.</li>
</ul>
<p>Here is an example:</p>
<div class="fragment"><pre class="fragment"><span class="comment">//Compile with:</span>
<span class="comment">//gcc -Wall -o eina_log_02 eina_log_02.c `pkg-config --cflags --libs eina`</span>

<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;Eina.h&gt;</span>

<span class="keywordtype">void</span> test(<span class="keywordtype">int</span> i)
{
   <a class="code" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG</a>(<span class="stringliteral">&quot;Entering test&quot;</span>);

   <span class="keywordflow">if</span> (i &lt; 0)
     {
         <a class="code" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b">EINA_LOG_ERR</a>(<span class="stringliteral">&quot;Argument is negative&quot;</span>);
         <span class="keywordflow">return</span>;
     }

   <a class="code" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO</a>(<span class="stringliteral">&quot;argument non negative&quot;</span>);

   <a class="code" href="group__Eina__Log__Group.html#ga09b88349373c2158f988d72375af5849">EINA_LOG_DBG</a>(<span class="stringliteral">&quot;Exiting test&quot;</span>);
}

<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
   <span class="keywordflow">if</span> (!<a class="code" href="group__Eina__Main__Group.html#gafee4bfc0e509b6ffed6598edf6f4b3de" title="Initializes the Eina library.">eina_init</a>())
     {
         printf(<span class="stringliteral">&quot;log during the initialization of Eina_Log module\n&quot;</span>);
         <span class="keywordflow">return</span> EXIT_FAILURE;
     }

   <a class="code" href="group__Eina__Log__Group.html#ga3588dded50cc324ab6f84da2f328bd8e" title="Sets the default log level.">eina_log_level_set</a>(<a class="code" href="group__Eina__Log__Group.html#gga326699509b2e7578ace7c0a15b4a8c1aafdc5a5cfb78f5e4d5851447ed798af50">EINA_LOG_LEVEL_DBG</a>);

   test(-1);
   test(0);

   <a class="code" href="group__Eina__Main__Group.html#ga2c8b4020427108a30c44707af22c99d3" title="Shuts down the Eina library.">eina_shutdown</a>();

   <span class="keywordflow">return</span> EXIT_SUCCESS;
}
</pre></div><p>If you compiled Eina without debug mode, execution will yield only one log message, which is "argument is negative".</p>
<p>Here we introduce the concept of logging domains (or loggers), which might already be familiar to readers. It is basically a way to separate a set of log messages into a context (e.g. a module) and provide a way of controlling this set as a whole.</p>
<p>For example, suppose you have 3 different modules in your application and you want to get logging only from one of them (e.g. create some sort of filter). For achieving that, all you need to do is create a logging domain for each module so that all logging inside a module can be considered as a whole.</p>
<p>Logging domains are specified by a name, color applied to the name and the level. The first two (name and color) are set through code, that is, inside your application/module/library.</p>
<p>The level is used for controlling which messages should appear. It specifies the lowest level that should be displayed (e.g. a message with level 11 being logged on a domain with level set to 10 would be displayed, while a message with level 9 wouldn't).</p>
<p>The domain level is set during runtime (in contrast with the name and color) through the environment variable EINA_LOG_LEVELS. This variable expects a list in the form domain_name1:level1,domain_name2:level2,... . For example:</p>
<div class="fragment"><pre class="fragment">EINA_LOG_LEVELS=mymodule1:5,mymodule2:2,mymodule3:0 ./myapp</pre></div><p>This line would set mymodule1 level to 5, mymodule2 level to 2 and mymodule3 level to 0.</p>
<p>There's also a global logger to which EINA_LOG_(ERR, DBG, INFO, CRIT, WARN) macros do log on. It is a logger that is created internally by Eina Log with an empty name and can be used for general logging (where logging domains do not apply).</p>
<p>Since this global logger doesn't have a name, you can't set its level through EINA_LOG_LEVELS variable. Here we introduce a second environment variable that is a bit more special: EINA_LOG_LEVEL.</p>
<p>This variable specifies the level of the global logging domain and the level of domains that haven't been set through EINA_LOG_LEVELS. Here's an example:</p>
<div class="fragment"><pre class="fragment">EINA_LOG_LEVEL=3 EINA_LOG_LEVELS=module1:10,module3:2 ./myapp</pre></div><p>Supposing you have modules named "module1", "module2" and "module3", this line would result in module1 with level 10, module2 with level 3 and module3 with level 2. Note that module2's level wasn't specified, so it's level is set to the global level. This way we can easily apply filters to multiple domains with only one parameter (EINA_LOG_LEVEL=num).</p>
<p>The global level (EINA_LOG_LEVEL) can also be set through code, using <a class="el" href="group__Eina__Log__Group.html#ga3588dded50cc324ab6f84da2f328bd8e" title="Sets the default log level.">eina_log_level_set()</a> function.</p>
<p>While developing your libraries or applications, you may notice that EINA_LOG_DOM_(ERR, DBG, INFO, CRIT, WARN) macros also print out messages from eina itself. Here we introduce another environment variable that is a bit more special: EINA_LOG_LEVELS_GLOB.</p>
<p>This variable allows you to disable the logging of any/all code in eina itself. This is useful when developing your libraries or applications so that you can see your own domain's messages easier without having to sift through a lot of internal eina debug messages. Here's an example:</p>
<div class="fragment"><pre class="fragment">EINA_LOG_LEVEL=3 EINA_LOG_LEVELS_GLOB=eina_*:0 ./myapp</pre></div><p>This will disable eina_log output from all internal eina code thus allowing you to see your own domain messages easier.</p>
<h2><a class="anchor" id="tutorial_log_advanced_display"></a>
Advanced usage of print callbacks</h2>
<p>The log module allows the user to change the way <a class="el" href="group__Eina__Log__Group.html#gacfaa1654ef8376b9fc741a611d9a15c2" title="Prints out log message using given domain and level.">eina_log_print()</a> displays the messages. It suffices to pass to <a class="el" href="group__Eina__Log__Group.html#gac7291079db979a0195d62d5526b27c30">eina_log_print_cb_set()</a> the function used to display the message. That function must be of type <a class="el" href="group__Eina__Log__Group.html#ga76501a2d10e374980c4012664e4ca96f">Eina_Log_Print_Cb</a>. As a custom data can be passed to that callback, powerful display messages can be displayed.</p>
<p>It is suggested to not use __FILE__, __FUNCTION__ or __LINE__ when writing that callback, but when defining macros (like <a class="el" href="group__Eina__Log__Group.html#ga2e33caeeeb6051526c01b7fea4d6c91b">EINA_LOG_ERR()</a> and other macros).</p>
<p>Here is an example of custom callback, whose behavior can be changed at runtime:</p>
<div class="fragment"><pre class="fragment"><span class="comment">//Compile with:</span>
<span class="comment">//gcc -Wall -o eina_log_03 eina_log_03.c `pkg-config --cflags --libs eina`</span>

<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;Eina.h&gt;</span>

<span class="preprocessor">#define log(fmt, ...)                                    \</span>
<span class="preprocessor">   eina_log_print(EINA_LOG_LEVEL_ERR, __FILE__, __FUNCTION__, __LINE__, fmt, ##__VA_ARGS__)</span>
<span class="preprocessor"></span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>_Data Data;

<span class="keyword">struct </span>_Data
{
   <span class="keywordtype">int</span> to_stderr;
};

<span class="keywordtype">void</span> print_cb(<span class="keyword">const</span> <a class="code" href="struct__Eina__Log__Domain.html">Eina_Log_Domain</a> *domain,
              <a class="code" href="group__Eina__Log__Group.html#ga5c0cd3a8463b76bb855805b70f58c7dd">Eina_Log_Level</a> level EINA_UNUSED,
              <span class="keyword">const</span> <span class="keywordtype">char</span> *file,
              <span class="keyword">const</span> <span class="keywordtype">char</span> *fnc,
              <span class="keywordtype">int</span> line,
              <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt,
              <span class="keywordtype">void</span> *data,
              va_list args)
{
   Data *d;
   FILE *output;
   <span class="keywordtype">char</span> *str;

   d = (Data*)data;
   <span class="keywordflow">if</span> (d-&gt;to_stderr)
     {
        output = stderr;
        str = <span class="stringliteral">&quot;stderr&quot;</span>;
    }
   <span class="keywordflow">else</span>
     {
       output = stdout;
        str = <span class="stringliteral">&quot;stdout&quot;</span>;
     }

   fprintf(output, <span class="stringliteral">&quot;%s:%s:%s (%d) %s: &quot;</span>,
           domain-&gt;<a class="code" href="struct__Eina__Log__Domain.html#adac00ef51a0009e12583ca5932275f2e">domain_str</a>, file, fnc, line, str);
   vfprintf(output, fmt, args);
   putc(<span class="charliteral">&#39;\n&#39;</span>, output);
}

<span class="keywordtype">void</span> test(Data *data, <span class="keywordtype">int</span> i)
{
   <span class="keywordflow">if</span> (i &lt; 0)
      data-&gt;to_stderr = 0;
   <span class="keywordflow">else</span>
      data-&gt;to_stderr = 1;

   <a class="code" href="group__Eina__Log__Group.html#gafb145e82df0f9441244832c94e87a21b">EINA_LOG_INFO</a>(<span class="stringliteral">&quot;Log message...&quot;</span>);
}

<span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)
{
   Data data;

   <span class="keywordflow">if</span> (!<a class="code" href="group__Eina__Main__Group.html#gafee4bfc0e509b6ffed6598edf6f4b3de" title="Initializes the Eina library.">eina_init</a>())
     {
        printf(<span class="stringliteral">&quot;log during the initialization of Eina_Log module\n&quot;</span>);
        <span class="keywordflow">return</span> EXIT_FAILURE;
     }

   <a class="code" href="group__Eina__Log__Group.html#gac7291079db979a0195d62d5526b27c30">eina_log_print_cb_set</a>(print_cb, &amp;data);

   test(&amp;data, -1);
   test(&amp;data, 0);

   <a class="code" href="group__Eina__Main__Group.html#ga2c8b4020427108a30c44707af22c99d3" title="Shuts down the Eina library.">eina_shutdown</a>();

   <span class="keywordflow">return</span> EXIT_SUCCESS;
}
</pre></div> </div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
