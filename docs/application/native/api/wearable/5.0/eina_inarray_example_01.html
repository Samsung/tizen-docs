<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Eina inline array usage</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('eina_inarray_example_01.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Eina inline array usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example creates an inline array of chars, adds some elements, prints them, re-purposes the array to store ints, adds some elements and prints that.</p>
<p>We are going to start with a function to compare ints. We need this because the '&gt;' operator is not a function and can't be used where Eina_Compare_Cb is needed. <div class="fragment"><pre class="fragment"><span class="keywordtype">int</span>
cmp(<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b)
{
   <span class="keywordflow">return</span> *(<span class="keywordtype">int</span>*)a &gt; *(<span class="keywordtype">int</span>*)b;
}
</pre></div></p>
<p>And then move on to the code we actually care about, starting with variable declarations and eina initialization: <div class="fragment"><pre class="fragment">
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc EINA_UNUSED, <span class="keywordtype">char</span> **argv EINA_UNUSED)
{
   <a class="code" href="struct__Eina__Inarray.html" title="Inline array structure.">Eina_Inarray</a> *iarr;
   <span class="keywordtype">char</span> ch, *ch2;
   <span class="keywordtype">int</span> a, *b;

   <a class="code" href="group__Eina__Main__Group.html#gafee4bfc0e509b6ffed6598edf6f4b3de" title="Initializes the Eina library.">eina_init</a>();
</pre></div></p>
<p>Creating an inline array is very simple, we just need to know what type we want to store: <div class="fragment"><pre class="fragment">   iarr = <a class="code" href="group__Eina__Inline__Array__Group.html#ga38a116a1355055b470c31bb4f633e53b" title="Creates a new inline array.">eina_inarray_new</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), 0);
</pre></div> </p>
<dl class="note"><dt><b>Note:</b></dt><dd>The second parameter(the step) is left at zero which means that eina chooses an appropriate value, this should <b>only</b> be changed if it's known, beforehand, that how many elements the array has.</dd></dl>
<p>Once we have an array we can start adding elements to it. Because the insertion function expects a memory address we have to put the value we want to store in a variable (this should be no problem since in the real world usage that's usually where the value is anyways): <div class="fragment"><pre class="fragment">
   ch = <span class="charliteral">&#39;a&#39;</span>;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;ch);
</pre></div> </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Because the inline array copies the value given to it we can later change <code>ch</code>, which we do, without affecting the contents of the array.</dd></dl>
<p>So let's add some more elements: <div class="fragment"><pre class="fragment">   ch = <span class="charliteral">&#39;b&#39;</span>;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;ch);
   ch = <span class="charliteral">&#39;c&#39;</span>;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;ch);
   ch = <span class="charliteral">&#39;d&#39;</span>;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;ch);
</pre></div></p>
<p>We then iterate over our array and print every position of it. The thing to note here is not so much the values, which are the expected 'a', 'b', 'c', and 'd', but rather the memory address of these values, they are sequential: <div class="fragment"><pre class="fragment">
   printf(<span class="stringliteral">&quot;Inline array of chars:\n&quot;</span>);
   <a class="code" href="group__Eina__Inline__Array__Group.html#gab6ffcad27b5099aa34af9ecd5e2b22f9" title="Walks through an array linearly from head to tail.">EINA_INARRAY_FOREACH</a>(iarr, ch2)
     printf(&quot;<span class="keywordtype">char</span>: %c(pointer: %p)\n&quot;, *ch2, ch2);
</pre></div></p>
<p>We are now going to use our array to store ints, so we need to first erase every member currently on the array: <div class="fragment"><pre class="fragment">
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga4e2b2a5b7d01613db5b578d8dbec36b7" title="Removes every member from the array.">eina_inarray_flush</a>(iarr);
</pre></div></p>
<p>And then to be able to store a different type on the same array, we use the <a class="el" href="group__Eina__Inline__Array__Group.html#ga97ceb13e335d8b8aae8dfcce735ec274" title="Initializes an inline array.">eina_inarray_step_set()</a> function, which is just like the <a class="el" href="group__Eina__Inline__Array__Group.html#ga38a116a1355055b470c31bb4f633e53b" title="Creates a new inline array.">eina_inarray_new()</a> function except it receives an already allocated memory. This time we're going to ask eina to use a step of size 4 because that's how many elements we are going to put in the array: <div class="fragment"><pre class="fragment">   <a class="code" href="group__Eina__Inline__Array__Group.html#ga97ceb13e335d8b8aae8dfcce735ec274" title="Initializes an inline array.">eina_inarray_step_set</a>(iarr, <span class="keyword">sizeof</span>(<a class="code" href="struct__Eina__Inarray.html" title="Inline array structure.">Eina_Inarray</a>), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), 4);
</pre></div> </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Strictly speaking the reason to call <a class="el" href="group__Eina__Inline__Array__Group.html#ga97ceb13e335d8b8aae8dfcce735ec274" title="Initializes an inline array.">eina_inarray_step_set()</a> is not because we're storing a different type, but because our types have different sizes. Eina inline arrays don't actually know anything about types, they only deal with blocks of memory of a given size. </dd>
<dd>
Since <a class="el" href="group__Eina__Inline__Array__Group.html#ga97ceb13e335d8b8aae8dfcce735ec274" title="Initializes an inline array.">eina_inarray_step_set()</a> receives already allocated memory, you can (and it is in fact a good practice) use inline arrays that are not declared as pointers: <div class="fragment"><pre class="fragment"> <a class="code" href="struct__Eina__Inarray.html" title="Inline array structure.">Eina_Inarray</a> arr;
 <a class="code" href="group__Eina__Inline__Array__Group.html#ga97ceb13e335d8b8aae8dfcce735ec274" title="Initializes an inline array.">eina_inarray_step_set</a>(&amp;arr, <span class="keyword">sizeof</span>(arr), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), 4);
</pre></div></dd></dl>
<p>And now to add our integer values to the array: <div class="fragment"><pre class="fragment">
   a = 97;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;a);
   a = 98;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;a);
   a = 100;
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga52922638db5729e9c83caa0b5b29d6dd" title="Copies the data as the last member of the array.">eina_inarray_push</a>(iarr, &amp;a);
</pre></div></p>
<p>Just to change things up a bit we've left out the 99 value, but we still add it in such a way that it keeps the array ordered. There are many ways to do this, we could use <a class="el" href="group__Eina__Inline__Array__Group.html#ga7d85c813706f99c9d59ab14908a22add" title="Copies the data at the given position in the array.">eina_inarray_insert_at()</a>, or we could change the value of the last member using <a class="el" href="group__Eina__Inline__Array__Group.html#ga8dddffaaca8580d964bd19147d03ce33" title="Copies the data to the given position.">eina_inarray_replace_at()</a> and then append the values in the right order, but for no particular reason we're going to use <a class="el" href="group__Eina__Inline__Array__Group.html#gadf3babcfe8feeea716ddbabc3bbee373" title="Copies the data to the array at a position found by the comparison function.">eina_inarray_insert_sorted()</a> instead: <div class="fragment"><pre class="fragment">   a = 99;
   <a class="code" href="group__Eina__Inline__Array__Group.html#gadf3babcfe8feeea716ddbabc3bbee373" title="Copies the data to the array at a position found by the comparison function.">eina_inarray_insert_sorted</a>(iarr, &amp;a, cmp);
</pre></div></p>
<p>We then print the size of our array, and the array itself, much like last time the values are not surprising, and neither should it be that the memory addresses are contiguous: <div class="fragment"><pre class="fragment">
   printf(<span class="stringliteral">&quot;Inline array of integers with %d elements:\n&quot;</span>, <a class="code" href="group__Eina__Inline__Array__Group.html#gaf6d3ce4a7b0b8e521e2c91024065d97d" title="Counts the number of members in an array.">eina_inarray_count</a>(iarr));
   <a class="code" href="group__Eina__Inline__Array__Group.html#gab6ffcad27b5099aa34af9ecd5e2b22f9" title="Walks through an array linearly from head to tail.">EINA_INARRAY_FOREACH</a>(iarr, b)
     printf(&quot;<span class="keywordtype">int</span>: %d(pointer: %p)\n&quot;, *b, b);
</pre></div></p>
<p>Once done we free our array and shutdown eina: <div class="fragment"><pre class="fragment">
   <a class="code" href="group__Eina__Inline__Array__Group.html#ga369b3090b7c04377eaceb6bebfe36e06" title="Frees an array and its members.">eina_inarray_free</a>(iarr);
   <a class="code" href="group__Eina__Main__Group.html#ga2c8b4020427108a30c44707af22c99d3" title="Shuts down the Eina library.">eina_shutdown</a>();
}
</pre></div></p>
<p>The source for this example: <a class="el" href="eina_inarray_01_c.html">eina_inarray_01.c</a> </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
