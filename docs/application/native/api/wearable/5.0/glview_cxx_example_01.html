<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Glview example with C++ Binding</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('glview_cxx_example_01.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Glview example with C++ Binding </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this example we'll illustrate how to use Glview and it's features.</p>
<p>The first part consists of including the headers. In this case we need to include <code>Elementary.hh</code>, <code>Evas_GL.h</code> and <code>stdio.h</code>.</p>
<ul>
<li><code>Elementary.hh:</code> library for Elementary with support for C++ language;</li>
</ul>
<ul>
<li><code>Evas_GL.h:</code> has functions that are used to do OpenGL rendering on Evas, Evas allows us to use OpenGL to render to specially set up image objects, which act as render target surfaces.</li>
</ul>
<ul>
<li><code>stdio.h</code> is a C library with functions tha perform Input/Output operations.</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Continuing with the code, at this point we create a GL related struct:</p>
<ul>
<li><code>Evas_GL_API</code> that is the structure type of the Evas GL API object that contains the GL APIs to be used in Evas GL.</li>
</ul>
<ul>
<li><code>GLuint</code> one of the pre-defined types of OpenGL which is a unsigned binary integer.</li>
</ul>
<ul>
<li><code>int</code> AKA <code>int</code>.</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Here we're simply initializing a type float, that we named red.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>In this example we'll need a type C helper function to load shaders from a shader source.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Inside this function we create the shader objectand load/compile shader source.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Completing our load shader function.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>This example will also need a function to initialize the shader and program object.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>In this function we load the vertex/fragment shaders, create the program object and finish our funtion.</p>
<p><div class="fragment"><pre class="fragment"></pre></div>  }</p>
<p>We need the following callbacks:</p>
<ul>
<li>initialize callback: that get called once for initialization;</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<ul>
<li>delete callback: gets called when glview is deleted;</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<ul>
<li>resize callback: gets called every time object is resized;</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<ul>
<li>draw callback: is where all the main GL rendering happens.</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Inside this callback, we'll draw a triangle.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Still inside as an option we are going to flush the GL pipeline and end our callback.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>We create <code>_anim</code> to notify that glview has changed so it can render.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Now that we finished with the GL preparations, we'll start the main code and initialize our GLData pointer object to NULL and run a check just in case.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Let's set the elm_policy, which defines for a given policy group/identifier a new policy's value, respectively. In this example the only policy we need to set a value for is <code>ELM_POLICY_QUIT</code>, possibles values for it are:</p>
<ul>
<li><code>ELM_POLICY_QUIT_NONE:</code> Never quit the application automatically;</li>
</ul>
<ul>
<li><code>ELM_POLICY_QUIT_LAST_WINDOW_CLOSED:</code> quit when the application's last window is closed;</li>
</ul>
<ul>
<li><code>ELM_POLICY_QUIT_LAST_WINDOW_HIDDEN</code> : quit when the application's last window is hidden;</li>
</ul>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>As you can see, the policy we chose was to quit when the last win is hidden as opose to examples with the C bindings where we perpetually set it to quit when last win was closed. This changed was necessary because in C++ binding as the elm mainloop stop running all object are destroyed, references are unreferenced and events are stopped at <a class="el" href="group__Elm__General.html#ga50fe52d513f7e89c9c770afd76de7ad9">ELM_MAIN()</a>.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>For more details consult <a class="el" href="group__Elm__General.html#ga7a05f37fd3a019da5e26c5fc91fcd937">elm_policy_set</a></dd></dl>
<p>Next step is creating an elementary window, in this example we use the C++ binding method with the elm_win_util_standard_add that is a elm_win_legacy function, better explained below. And then we set the autohide state for it.</p>
<p><code>elm_win_util_standard_add</code> (const char *name, const char *tittle) Adds a window object with standard setup. Parameters:</p>
<ul>
<li><code>name</code> - The name of the window;</li>
</ul>
<ul>
<li><code>title</code> - The title for the window.</li>
</ul>
<p>This creates a window but also puts in a standard background with <code><a class="el" href="group__Elm__Bg.html#gaeec8f79ac62ce0cf607cfe330008a63f" title="Adds a new background to the parent.">elm_bg_add()</a></code>, as well as setting the window title to <code>title</code>. The window type created is of type <code>ELM_WIN_BASIC</code>, with the <code>NULL</code> as the parent widget. Returns the created object or <code>NULL</code> on failure.</p>
<p>The autohide works similarly to <code>autodel</code>, automatically handling "delete,request" signals when set to <code>true</code>, with the difference that it will hide the window, instead of destroying it.</p>
<p>It is specially designed to work together with <code>ELM_POLICY_QUIT_LAST_WINDOW_HIDDEN</code> which allows exiting Elementary's main loop when all the windows are hidden.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<dl class="note"><dt><b>Note:</b></dt><dd><code>autodel</code> and <em>autohide</em> are not mutually exclusive. The window will be destructed if both autodel and autohide is set to <code>EINA_TRUE</code> or <code>true</code>.</dd></dl>
<p>Now let's create a box with the C++ binding method, passing our window object as parent, we'll use this box to contain our glview object.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>To better understand, the function <code>size_hint_weight_set</code> for C++ bindings originated from C bindings function evas_object_size_hint_weight_set, that is EFL Evas type function. With this function we set the hints for an object's weight. The parameters are:</p>
<ul>
<li>x - Nonnegative double value to use as horizontal weight hint.</li>
</ul>
<ul>
<li>y - Nonnegative double value to use as vertical weight hint.</li>
</ul>
<p>This is not a size enforcement in any way, it's just a hint that should be used whenever appropriate. This is a hint on how a container object should resize a given child within its area.</p>
<p>Containers may adhere to the simpler logic of just expanding the child object's dimensions to fit its own (see the EVAS_HINT_EXPAND helper weight macro in the EFL Evas Documentation) or the complete one of taking each child's weight hint as real weights to how much of its size to allocate for them in each axis. A container is supposed to, after normalizing the weights of its children (with weight hints), distribute the space it has to layout them by those factors – most weighted children get larger in this process than the least ones.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<dl class="note"><dt><b>Note:</b></dt><dd>Default weight hint values are 0.0, for both axis.</dd></dl>
<p>Then we add the box as a resize-object to win informing that when the size of the win changes so should the box's size. Remember always to set the box visibility to true.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>In this part we'll create a new elm glview, using the C++ method, in this case it requires that we set <code>Evas_GL_Context_Version</code> with the version_constructor. <code>Evas_GL_Context_Version</code> is a enumeration that defines the available OpenGL ES version numbers, it can be used to create OpenGL-ES 1.1 contexts.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>The function size_hint_weight_set works with glview the same way as with box, for more, search above.</p>
<p>The function <code>size_hint_align_set</code> for C++ bindings originated from C bindings function evas_object_size_hint_align_set, that is EFL Evas type function. With this function we set the hints for an object's alignment. The parameters are:</p>
<ul>
<li>x - Double, ranging from 0.0 to 1.0 or with the special value EVAS_HINT_FILL, to use as horizontal alignment hint.</li>
</ul>
<ul>
<li>y - Double, ranging from 0.0 to 1.0 or with the special value EVAS_HINT_FILL, to use as vertical alignment hint.</li>
</ul>
<p>These are hints on how to align an object inside the boundaries of a container/manager. Accepted values are in the 0.0 to 1.0 range, with the special value EVAS_HINT_FILL used to specify "justify" or "fill" by some users. In this case, maximum size hints should be enforced with higher priority, if they are set. Also, any padding hint set on objects should add up to the alignment space on the final scene composition.</p>
<p>For the horizontal component, 0.0 means to the left, 1.0 means to the right. Analogously, for the vertical component, 0.0 to the top, 1.0 means to the bottom.</p>
<p>This is not a size enforcement in any way, it's just a hint that should be used whenever appropriate.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Default alignment hint values are 0.5, for both axis.</dd></dl>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Mode is simply for supporting alpha, depth buffering and stencil buffering.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Resize policy tells glview what to do with the surface when it resizes. ELM_VIEW_RESIZE_POLICY_RECREATE will tell it to destroy the current surface and recreate it to the new size.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Render policy tells glview how it would like glview to render gl code. ELM_GLVIEW_RENDER_POLICY_ON_DEMAND will have the gl calls called in the pixel_get callback, which only gets called if the object is visible, hence ON_DEMAND. ALWAYS mode renders it despite the visibility of the object.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Now we'll register our callbacks.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>When using the elm box the packing method of the subobj - glview in this case - should be defined. There are four possible methods:</p>
<ul>
<li><code>pack_start(subobj_)</code> - Add an object to the beginning of the pack list. Pack <code>subobj_</code> into the box obj, placing it first in the list of children objects. The actual position the object will get on screen depends on the layout used. If no custom layout is set, it will be at the top or left, depending if the box is vertical or horizontal, respectively.</li>
</ul>
<ul>
<li><code>pack_end(subobj_)</code> - Add an object at the end of the pack list. Pack <code>subobj_</code> into the box obj, placing it last in the list of children objects. The actual position the object will get on screen depends on the layout used. If no custom layout is set, it will be at the bottom or right, depending if the box is vertical or horizontal, respectively.</li>
</ul>
<ul>
<li><code>pack_before(subobj_, before_)</code> - Adds an object to the box before the indicated object. This will add the <code>subobj_</code> to the box indicated before the object indicated with <code>before_</code>. If before is not already in the box, results are undefined. Before means either to the left of the indicated object or above it depending on orientation.</li>
</ul>
<ul>
<li><code>pack_after(subobj_, after_)</code> - Adds an object to the box after the indicated object. This will add the <code>subobj_</code> to the box indicated after the object indicated with <code>after_</code>. If after is not already in the box, results are undefined. After means either to the right of the indicated object or below it depending on orientation.</li>
</ul>
<p>In this and most examples we use pack_end by choice and practicality, in this part of the code we also make glview visible and set to focus.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>For a simple demonstration of the animation we'll have to use ecore::animator. As long as tou trigger an update on the image via <code>changed_set()</code> it will be updated.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>If you delete gl, this animator will keep running trying to access gl so it's better to delete this animator with <a class="el" href="group__Ecore__Animator__Group.html#gaadfa590f3c1638035393ed9d7aa10e2f" title="Deletes the specified animator from the animator list.">ecore_animator_del()</a>, as seen inside the lambda function.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<dl class="note"><dt><b>Note:</b></dt><dd>To learn more about Lambda Function and its use in Elementary consult <a class="el" href="lambda.html">Lambda Functions with Elementary - C++11</a>.</dd></dl>
<p>We're going to add a "OK" button to end the program. First step is to create it using the C++ method, setting it's parent.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Second, set the text, alignment and weight hints, the hints work the same as with box and glview.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Pack our button in the same box as glview and set the visibility for it.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>As a final step for our button, we are going to add a clicked callback, using again Lambda Type Function.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<dl class="note"><dt><b>Note:</b></dt><dd>To learn more about Lambda Function and its use in Elementary consult <a class="el" href="lambda.html">Lambda Functions with Elementary - C++11</a>.</dd></dl>
<p>Now we only have to set the size for our window and make it visible.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>And finally, start the elm mainloop, starting to handle events and drawing operations.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>See full code for this example <a class="el" href="glview_cxx_example_01_8cc-example.html">here</a> . </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
