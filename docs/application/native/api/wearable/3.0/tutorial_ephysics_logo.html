<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: EPhysics - Logo</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">EPhysics - Logo </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this example is to demonstrate the EPhysics_Logo.</p>
<p>For this example we'll have an EPhysics_World.</p>
<p>The basic concepts like - initializing an EPhysics_World, render geometry, physics limiting boundaries, were already covered in <a class="el" href="tutorial_ephysics_bouncing_ball.html">EPhysics - Bouncing Ball</a></p>
<h2><a class="anchor" id="add-logostruct"></a>
Logo Data Struct</h2>
<p>While in this example we'll be working with a struct to hold some objects in our code. For clarity sake we present you the struct declaration in the following block.</p>
<p><div class="fragment"><pre class="fragment">   <span class="keyword">struct </span>letter_desc {
      <span class="keyword">const</span> <span class="keywordtype">char</span> *letter;
      <span class="keywordtype">int</span> padding;
   } falling_letters[] = {
     {<span class="stringliteral">&quot;P&quot;</span>, PADDING_X_1},
     {<span class="stringliteral">&quot;H&quot;</span>, PADDING_X_1},
     {<span class="stringliteral">&quot;Y&quot;</span>, PADDING_X_3},
     {<span class="stringliteral">&quot;S1&quot;</span>, PADDING_X_2},
     {<span class="stringliteral">&quot;I&quot;</span>, PADDING_X_2},
     {<span class="stringliteral">&quot;C&quot;</span>, PADDING_X_3},
     {<span class="stringliteral">&quot;S2&quot;</span>, 0}
   };
</pre></div></p>
<h2><a class="anchor" id="add-lett"></a>
Adding the letters</h2>
<p>To add the letters we'll use this function that creates the shadow, light and letter images.</p>
<p><div class="fragment"><pre class="fragment">_letter_add(<a class="code" href="group__Evas__Canvas.html#ga5ff87cc4ce6bc43e3b640a6d37f73043">Evas</a> *evas, <span class="keyword">const</span> <span class="keywordtype">char</span> *letter, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> **image, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> **light, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> **shadow)
{
   <span class="keywordtype">int</span> w, h, sh_w, sh_h;
   <span class="keywordtype">char</span> buf[1024];

   snprintf(buf, <span class="keyword">sizeof</span>(buf), PACKAGE_DATA_DIR <span class="stringliteral">&quot;/logo_shadow-%s.png&quot;</span>, letter);
   *shadow = <a class="code" href="group__Evas__Object__Image.html#ga0e8cb83d31d02bf583c75925b7cd14d7">evas_object_image_filled_add</a>(evas);
   <a class="code" href="group__Evas__Object__Image.html#gac27fd0ceabe5f56607b7a86d71577df1">evas_object_image_file_set</a>(*shadow, buf, NULL);
   <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(*shadow, &amp;sh_w, &amp;sh_h);
   <a class="code" href="group__Evas__Font__Group.html#ga21e8604c0e4a93e469bff4bd069e82b5">evas_object_resize</a>(*shadow, sh_w, sh_h);
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(*shadow, 0, 0, 0, 0);
   <a class="code" href="group__Evas__Font__Group.html#gac04277bfd84a7201ba329328a18e21fd">evas_object_layer_set</a>(*shadow, LAYER_SHADOW);
   <a class="code" href="group__Evas__Font__Group.html#ga9cbc13661584e49fb9d9cdab514a1eeb">evas_object_show</a>(*shadow);

   snprintf(buf, <span class="keyword">sizeof</span>(buf), PACKAGE_DATA_DIR <span class="stringliteral">&quot;/logo_letter-%s.png&quot;</span>, letter);
   *image = <a class="code" href="group__Evas__Object__Image.html#ga0e8cb83d31d02bf583c75925b7cd14d7">evas_object_image_filled_add</a>(evas);
   <a class="code" href="group__Evas__Object__Image.html#gac27fd0ceabe5f56607b7a86d71577df1">evas_object_image_file_set</a>(*image, buf, NULL);
   <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(*image, &amp;w, &amp;h);
   <a class="code" href="group__Evas__Font__Group.html#ga21e8604c0e4a93e469bff4bd069e82b5">evas_object_resize</a>(*image, w, h);
   <a class="code" href="group__Evas__Font__Group.html#gac04277bfd84a7201ba329328a18e21fd">evas_object_layer_set</a>(*image, LAYER_LETTER);
   <a class="code" href="group__Evas__Font__Group.html#ga9cbc13661584e49fb9d9cdab514a1eeb">evas_object_show</a>(*image);

   snprintf(buf, <span class="keyword">sizeof</span>(buf), PACKAGE_DATA_DIR <span class="stringliteral">&quot;/logo_light-%s.png&quot;</span>, letter);
   *light = <a class="code" href="group__Evas__Object__Image.html#ga0e8cb83d31d02bf583c75925b7cd14d7">evas_object_image_filled_add</a>(evas);
   <a class="code" href="group__Evas__Object__Image.html#gac27fd0ceabe5f56607b7a86d71577df1">evas_object_image_file_set</a>(*light, buf, NULL);
   <a class="code" href="group__Evas__Font__Group.html#ga21e8604c0e4a93e469bff4bd069e82b5">evas_object_resize</a>(*light, w, h);
   <a class="code" href="group__Evas__Font__Group.html#gac04277bfd84a7201ba329328a18e21fd">evas_object_layer_set</a>(*light, LAYER_LETTER);
   <a class="code" href="group__Evas__Font__Group.html#ga9cbc13661584e49fb9d9cdab514a1eeb">evas_object_show</a>(*light);

   <span class="comment">/* allow easy access to shadow and light from the letter image */</span>
   <a class="code" href="group__Evas__Object__Group__Extras.html#ga70134a7068c9bff4107a761abe0a2ad4">evas_object_data_set</a>(*image, <span class="stringliteral">&quot;shadow&quot;</span>, *shadow);
   <a class="code" href="group__Evas__Object__Group__Extras.html#ga70134a7068c9bff4107a761abe0a2ad4">evas_object_data_set</a>(*image, <span class="stringliteral">&quot;light&quot;</span>, *light);
}
</pre></div></p>
<p>In this loop we'll use the function letter_add using the falling_letters declared in logo data struct.</p>
<p><div class="fragment"><pre class="fragment">   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__Eina__Types__Group.html#ga7c1b6f81660b4e30516169e9e7d3261c">EINA_C_ARRAY_LENGTH</a>(falling_letters); i++)
     {
        _letter_add(evas, falling_letters[i].letter, &amp;image, &amp;light, &amp;shadow);

        <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(shadow, &amp;sh_w, NULL);
        <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(image, &amp;w, &amp;h);
</pre></div></p>
<p>Place image and light on top, above what the viewport can show, to fall later on.</p>
<p><div class="fragment"><pre class="fragment">        <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(image, x, -h * (i + 1) - 50);
        <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(light, x, -h * (i + 1) - 50);
</pre></div></p>
<p>Place shadow below the hit-line: FLOOR_Y, centered at image.</p>
<p><div class="fragment"><pre class="fragment">        <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(shadow, x + CENTER(w, sh_w), FLOOR_Y);
</pre></div></p>
<p>Here we set the letters padding and add letter body using the function below and setting its friction.</p>
<p><div class="fragment"><pre class="fragment">        x += falling_letters[i].padding + w;

        letter_body = _letter_body_box_add(world, image);
        ephysics_body_friction_set(letter_body, 0.4);
     }
</pre></div></p>
<p>Here we call another function that will be common to the circle body as well, note that we add a callback that will be explained later. <p><div class="fragment"><pre class="fragment">_letter_body_box_add(EPhysics_World *world, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *image)
{
   EPhysics_Body *body = ephysics_body_box_add(world);

   _letter_body_setup_common(body, image);

   ephysics_body_event_callback_add
     (body, EPHYSICS_CALLBACK_BODY_UPDATE, _update_box_cb, NULL);

   <span class="keywordflow">return</span> body;
}
</pre></div></p>
<p>This function is used to create the body setting its properties. Note that we disable its angular movement (rotation) on Z axis to this letters don't tilt or recline. <p><div class="fragment"><pre class="fragment">_letter_body_setup_common(EPhysics_Body *body, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *view)
{
   ephysics_body_evas_object_set(body, view, <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>);
   ephysics_body_mass_set(body, 1.2);
   ephysics_body_restitution_set(body, 0.6);
   ephysics_body_angular_movement_enable_set(body, <a class="code" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>, <a class="code" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>,
                                             <a class="code" href="group__Eina__Types__Group.html#ga1feb115f8e9913e806e090d9bd5a7301">EINA_FALSE</a>);
}
</pre></div></p>
<p>In this callback function that we added to our letter body we'll update its light and shadow.</p>
<p>First we'll update the body, get its image geometry and set the floor distance based on images height.</p>
<p><div class="fragment"><pre class="fragment">_update_box_cb(<span class="keywordtype">void</span> *data __UNUSED__, EPhysics_Body *body, <span class="keywordtype">void</span> *event_info)
{
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *image = event_info;
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *shadow = <a class="code" href="group__Evas__Object__Group__Extras.html#gafbad43015793eda4ae50202c0ce0e652">evas_object_data_get</a>(image, <span class="stringliteral">&quot;shadow&quot;</span>);
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *light = <a class="code" href="group__Evas__Object__Group__Extras.html#gafbad43015793eda4ae50202c0ce0e652">evas_object_data_get</a>(image, <span class="stringliteral">&quot;light&quot;</span>);
   <span class="keywordtype">int</span> x, y, w, h, floor_distance, alpha = 0;

   <span class="comment">/* modify the evas object according to the body */</span>
   ephysics_body_evas_object_update(body);
   <a class="code" href="group__Evas__Font__Group.html#ga6f52fab1a96dc58c85ee481d84bac871">evas_object_geometry_get</a>(image, &amp;x, &amp;y, &amp;w, &amp;h);

   floor_distance = FLOOR_Y - h;
</pre></div></p>
<p>As long as the letter approaches the floor, its shadow is darker, with bigger y.</p>
<p><div class="fragment"><pre class="fragment">   <span class="keywordflow">if</span> (y &gt; SH_THRESHOLD)
     {
        <span class="keywordtype">int</span> sh_w, sh_h;
        <span class="keywordtype">double</span> pos_x;

        <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(shadow, &amp;sh_w, &amp;sh_h);
        alpha = 255 * (y - SH_THRESHOLD) / (floor_distance - SH_THRESHOLD);
</pre></div></p>
<p>And with bigger x -- its proportional to x / WIDTH, but varies from 100 to 255</p>
<p><div class="fragment"><pre class="fragment">        pos_x = (double) x / (WIDTH - w);
        alpha = alpha * PROP_GET(pos_x, 100, 255);
</pre></div></p>
<p>Note that the box shadow is not resized, just moved. And here set also the colors.</p>
<p><div class="fragment"><pre class="fragment">        <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(shadow, x + CENTER(w, sh_w) + SH_OFFSET_X,
                         FLOOR_Y - sh_h + 2);
     }
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(shadow, alpha, alpha, alpha, alpha);
</pre></div></p>
<p>As long as the letter approaches the floor, its lighter, with bigger x and y.</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(light, x, y);
   alpha = (y &lt;= 0) ? 0 : y * 255 / floor_distance;
   alpha = alpha * (x - OFFSET_X + 80) / (WIDTH - OFFSET_X);
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(light, alpha, alpha, alpha, alpha);
}
</pre></div></p>
<h2><a class="anchor" id="add-lettere"></a>
Adding the letter E</h2>
<p>Here we'll add the last letter, "E" is a circle that comes rolling on the floor.</p>
<p>First we use the letter_add function, set its shadow color and get its sizes.</p>
<p><div class="fragment"><pre class="fragment">   _letter_add(evas, <span class="stringliteral">&quot;E&quot;</span>, &amp;image, &amp;light, &amp;shadow);
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(shadow, 255, 255, 255, 255);

   <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(shadow, &amp;sh_w, NULL);
   <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(image, &amp;w, &amp;h);
</pre></div></p>
<p>Place image and light above the floor and to the left of viewport, to comes rolling later on.</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(image, -w - 1, FLOOR_Y - h + 1);
   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(light, -w - 1, FLOOR_Y - h + 1);
</pre></div></p>
<p>Place the shadow below the hit-line: FLOOR_Y centered at image.</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(shadow, -w - 1 + CENTER(w, sh_w), FLOOR_Y);
</pre></div></p>
<p>Here we create the body using body_circle function and enable its rotation on Z axis.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Make the "E" logo get into the viewport by applying a horizontal force.</p>
<p><div class="fragment"><pre class="fragment"></pre></div></p>
<p>Here we use the letter_body_setup_common to create the body and set its properties, note that we add a callback that will be explained below. <p><div class="fragment"><pre class="fragment">_letter_body_circle_add(EPhysics_World *world, <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *image)
{
   EPhysics_Body *body = ephysics_body_cylinder_add(world);

   _letter_body_setup_common(body, image);

   ephysics_body_event_callback_add
     (body, EPHYSICS_CALLBACK_BODY_UPDATE, _update_circle_cb, NULL);

   <span class="keywordflow">return</span> body;
}
</pre></div></p>
<p>In this callback function that we added to our "E" letter body we'll update its light and shadow.</p>
<p>First we'll update the body and get its image geometry.</p>
<p><div class="fragment"><pre class="fragment">_update_circle_cb(<span class="keywordtype">void</span> *data __UNUSED__, EPhysics_Body *body, <span class="keywordtype">void</span> *event_info)
{
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *image = event_info;
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *shadow = <a class="code" href="group__Evas__Object__Group__Extras.html#gafbad43015793eda4ae50202c0ce0e652">evas_object_data_get</a>(image, <span class="stringliteral">&quot;shadow&quot;</span>);
   <a class="code" href="group__Evas__Object__Group.html#ga9e19e6dd1f517a0ba437c0114d3e7c97">Evas_Object</a> *light = <a class="code" href="group__Evas__Object__Group__Extras.html#gafbad43015793eda4ae50202c0ce0e652">evas_object_data_get</a>(image, <span class="stringliteral">&quot;light&quot;</span>);
   <span class="keywordtype">int</span> x, y, w, h, sh_w, sh_h, alpha = 0;
   <span class="keyword">const</span> <a class="code" href="group__Evas.html#gacbda626e8d8bf52e7e3146d26d8153a7" title="An opaque handle to map points.">Evas_Map</a> *map;

   <span class="comment">/* modify the evas object according to the body */</span>
   ephysics_body_evas_object_update(body);
   <a class="code" href="group__Evas__Font__Group.html#ga6f52fab1a96dc58c85ee481d84bac871">evas_object_geometry_get</a>(image, &amp;x, &amp;y, &amp;w, &amp;h);
</pre></div></p>
<p>As long as the letter approaches the floor, its lighter, with bigger x.</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(light, x, y);
   alpha = x * 255 / (WIDTH - w);
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(light, alpha, alpha, alpha, alpha);
</pre></div></p>
<p>Use the same map from image to the light (rotate it).</p>
<p><div class="fragment"><pre class="fragment">   map = evas_object_map_get(image);
   evas_object_map_set(light, map);
   evas_object_map_enable_set(light, <a class="code" href="group__Eina__Types__Group.html#ga05c12dacc8b4058994df842b41be85fc">EINA_TRUE</a>);
</pre></div></p>
<p>As long as the letter approaches the floor, its shadow is darker, with bigger y.</p>
<p><div class="fragment"><pre class="fragment">   <a class="code" href="group__Evas__Object__Image.html#ga6307d5c3560528d7525a6c2ed16360ed">evas_object_image_size_get</a>(shadow, &amp;sh_w, &amp;sh_h);
   <a class="code" href="group__Evas__Font__Group.html#ga02da8091bbac768b8e86c7b74b2a94f9">evas_object_move</a>(shadow, x + CENTER(w, sh_w) + SH_OFFSET_X,
                    FLOOR_Y - sh_h + 2);
   alpha = 127 + alpha / 2;
   <a class="code" href="group__Evas__Font__Group.html#gae34bdcfd7f5100151f6ea8ef4a392949">evas_object_color_set</a>(shadow, alpha, alpha, alpha, alpha);
</pre></div></p>
<p>When the letter "E" passes the viewport, we send it to the begin again to collide with the other letters.</p>
<p><div class="fragment"><pre class="fragment">   <span class="keywordflow">if</span> (x &gt; E_THRESHOLD)
     ephysics_body_move(body, -w - 1, y, -15);
}
</pre></div></p>
<p>Here we finish the example. The full source code can be found at <a class="el" href="ephysics_logo_c.html">ephysics_logo.c</a>. </p>
</div></div><!-- contents -->
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
