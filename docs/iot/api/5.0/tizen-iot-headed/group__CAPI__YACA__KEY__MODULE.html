<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: YACA Key Management</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__CAPI__YACA__KEY__MODULE.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#define-members">Defines</a>  </div>
  <div class="headertitle">
<div class="title">YACA Key Management</div>  </div>
<div class="ingroups"><a class="el" href="group__CAPI__YACA__MODULE.html">YACA</a></div></div><!--header-->
<div class="contents">
<hr/><a name="details" id="details"></a><h2> </h2>
<p>Provides APIs for key handling operations such as generating and importing a key. </p>
<h2><a class="anchor" id="CAPI_YACA_KEY_MODULE_HEADER"></a>
Required Header</h2>
<p>#include &lt;yaca/yaca_key.h&gt;<br/>
</p>
<h2><a class="anchor" id="CAPI_YACA_KEY_MODULE_OVERVIEW"></a>
Overview</h2>
<p>It provides APIs for generating key using random number or password, importing a key trying to match it to the key_type specified and exporting a key to arbitrary format.</p>
<h2><a class="anchor" id="CAPI_YACA_KEY_MODULE_EXAMPLES"></a>
Examples</h2>
<p>Key generation API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> key_params = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Regular generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa49c9fbb5f7d3c0184813a717467b5ed8">YACA_KEY_LENGTH_2048BIT</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a7c862b36aa6379f365a4110d3e953a93">YACA_KEY_TYPE_DH_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa2143ee6d0bbd738529a889886e1406fa02137e4e989de00788445b47d7263bb2">YACA_KEY_LENGTH_DH_RFC_2048_224</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8abc222a3c14b6a7b9e56de795728a413c">YACA_KEY_TYPE_EC_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga6c3245122343a86ebe0b98731db96438a8eb77c452f724ebe6b09a4455d226b11">YACA_KEY_LENGTH_EC_SECP384R1</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);

    <span class="comment">/* Params + key generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a106734fbfa7d283c94b5b616b0640c6e">YACA_KEY_TYPE_DH_PARAMS</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa2143ee6d0bbd738529a889886e1406fa835b74e6d7d6ba2fbda96b55d30dd4c5">YACA_KEY_LENGTH_DH_RFC_2048_256</a>, &amp;key_params);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c" title="Generates a secure private asymmetric key from parameters.">yaca_key_generate_from_parameters</a>(key_params, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key_params);

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8ae5d4d4d8ff53622fb5ca553f799b28e3">YACA_KEY_TYPE_EC_PARAMS</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga6c3245122343a86ebe0b98731db96438a371c756a86a0da426ea7bd03a834ff3e">YACA_KEY_LENGTH_EC_PRIME256V1</a>, &amp;key_params);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c" title="Generates a secure private asymmetric key from parameters.">yaca_key_generate_from_parameters</a>(key_params, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key_params);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Symmetric key import/export API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> sym_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> raw_imported = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> b64_imported = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    <span class="keywordtype">char</span> *raw = NULL;
    <span class="keywordtype">size_t</span> raw_len;
    <span class="keywordtype">char</span> *b64 = NULL;
    <span class="keywordtype">size_t</span> b64_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>, &amp;sym_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* BASE64 */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(sym_key, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a3a618b9622631e48e4a1e9bed6563e1a">YACA_KEY_FILE_FORMAT_BASE64</a>, NULL,
                          &amp;b64, &amp;b64_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, NULL, b64, b64_len, &amp;b64_imported);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    printf(<span class="stringliteral">&quot;\t***** BASE64 exported key: *****\n%.*s\n&quot;</span>, (<span class="keywordtype">int</span>)b64_len, b64);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(b64);
    b64 = NULL;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(b64_imported, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a3a618b9622631e48e4a1e9bed6563e1a">YACA_KEY_FILE_FORMAT_BASE64</a>, NULL,
                          &amp;b64, &amp;b64_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    printf(<span class="stringliteral">&quot;\t***** BASE64 imported key: *****\n%.*s\n&quot;</span>, (<span class="keywordtype">int</span>)b64_len, b64);

    <span class="comment">/* RAW */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(sym_key, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a903f65488b202e5ea0158d49502dbe47">YACA_KEY_FILE_FORMAT_RAW</a>, NULL,
                          &amp;raw, &amp;raw_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, NULL, raw, raw_len, &amp;raw_imported);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* display key in hexadecimal format */</span>
    dump_hex(raw, raw_len, <span class="stringliteral">&quot;\n\t***** RAW exported key: *****&quot;</span>);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(raw);
    raw = NULL;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(raw_imported, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a903f65488b202e5ea0158d49502dbe47">YACA_KEY_FILE_FORMAT_RAW</a>, NULL,
                          &amp;raw, &amp;raw_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* display key in hexadecimal format */</span>
    dump_hex(raw, raw_len, <span class="stringliteral">&quot;\t***** RAW imported key: *****&quot;</span>);

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(sym_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(raw_imported);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(b64_imported);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(raw);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(b64);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Asymmetric key import/export API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> rsa_priv = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> rsa_pub = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> pem_priv_imported = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> der_pub_imported = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    <span class="keywordtype">char</span> *pem_priv = NULL;
    <span class="keywordtype">size_t</span> pem_priv_len;
    <span class="keywordtype">char</span> *der_pub = NULL;
    <span class="keywordtype">size_t</span> der_pub_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa49c9fbb5f7d3c0184813a717467b5ed8">YACA_KEY_LENGTH_2048BIT</a>, &amp;rsa_priv);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080" title="Extracts public key from a private one.">yaca_key_extract_public</a>(rsa_priv, &amp;rsa_pub);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* PEM private */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(rsa_priv, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a>, NULL,
                          &amp;pem_priv, &amp;pem_priv_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, NULL, pem_priv, pem_priv_len, &amp;pem_priv_imported);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    printf(<span class="stringliteral">&quot;\t***** PEM exported private key: *****\n%.*s&quot;</span>, (<span class="keywordtype">int</span>)pem_priv_len, pem_priv);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(pem_priv);
    pem_priv = NULL;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(pem_priv_imported, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a>,
                          NULL, &amp;pem_priv, &amp;pem_priv_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    printf(<span class="stringliteral">&quot;\t***** PEM imported private key: *****\n%.*s&quot;</span>, (<span class="keywordtype">int</span>)pem_priv_len, pem_priv);

    <span class="comment">/* DER public */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(rsa_pub, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1ab61e4cd29812bb76a23aa29278828822">YACA_KEY_FILE_FORMAT_DER</a>, NULL,
                          &amp;der_pub, &amp;der_pub_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8af507c1122a5dab50a29afdafa28847e8">YACA_KEY_TYPE_RSA_PUB</a>, NULL, der_pub, der_pub_len, &amp;der_pub_imported);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* display key in hexadecimal format */</span>
    dump_hex(der_pub, der_pub_len, <span class="stringliteral">&quot;\n\t***** DER exported public key: *****&quot;</span>);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(der_pub);
    der_pub = NULL;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(der_pub_imported, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1ab61e4cd29812bb76a23aa29278828822">YACA_KEY_FILE_FORMAT_DER</a>,
                          NULL, &amp;der_pub, &amp;der_pub_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* display key in hexadecimal format */</span>
    dump_hex(der_pub, der_pub_len, <span class="stringliteral">&quot;\t***** DER imported public key: *****&quot;</span>);

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(rsa_pub);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(rsa_priv);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(pem_priv_imported);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(der_pub_imported);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(pem_priv);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(der_pub);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Key import/export with password API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include  &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <span class="keywordtype">char</span> *password = NULL;
    <span class="keywordtype">char</span> *key_data = NULL;
    <span class="keywordtype">size_t</span> key_data_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa49c9fbb5f7d3c0184813a717467b5ed8">YACA_KEY_LENGTH_2048BIT</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Export key */</span>
    {
        ret = read_stdin_line(<span class="stringliteral">&quot;encryption pass: &quot;</span>, &amp;password);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(key, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6a2d1cb42106900c000653d3a06e851004">YACA_KEY_FORMAT_PKCS8</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a>, password,
                              &amp;key_data, &amp;key_data_len);
        <span class="keywordflow">if</span> (ret == <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a>)
            printf(<span class="stringliteral">&quot;invalid parameter, probably a missing password for PKCS8\n&quot;</span>);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);
        key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
        <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(password);
        password = NULL;
    }

    <span class="comment">/* Import key */</span>
    {
        ret = read_stdin_line(<span class="stringliteral">&quot;decryption pass: &quot;</span>, &amp;password);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8aa684692e131c425c852025f39e811d94">YACA_KEY_TYPE_RSA_PRIV</a>, password, key_data, key_data_len, &amp;key);
        <span class="keywordflow">if</span> (ret == <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4adbb893fd0d6bb79e0ebc98523a5da5d7">YACA_ERROR_INVALID_PASSWORD</a>)
            printf(<span class="stringliteral">&quot;invalid password\n&quot;</span>);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(key_data);
        key_data = NULL;

        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(key, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6a2d1cb42106900c000653d3a06e851004">YACA_KEY_FORMAT_PKCS8</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a>, password,
                              &amp;key_data, &amp;key_data_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        printf(<span class="stringliteral">&quot;%.*s&quot;</span>, (<span class="keywordtype">int</span>)key_data_len, key_data);
    }

exit:
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(key_data);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(password);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Diffie-Helmann key exchange API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keyword">static</span> <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> exchange_public_keys(<span class="keyword">const</span> <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> peer_key)
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> params = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> priv_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> pub_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gab5b21da412ea9063e9a03f680e19ddc5" title="Extracts parameters from a private or a public key.">yaca_key_extract_parameters</a>(peer_key, &amp;params);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c" title="Generates a secure private asymmetric key from parameters.">yaca_key_generate_from_parameters</a>(params, &amp;priv_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080" title="Extracts public key from a private one.">yaca_key_extract_public</a>(priv_key, &amp;pub_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(priv_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(params);

    <span class="keywordflow">return</span> pub_key;
}

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> priv_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> pub_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> peer_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> aes_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> iv = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    <span class="keywordtype">char</span> *secret = NULL;
    <span class="keywordtype">size_t</span> secret_len;
    <span class="keywordtype">char</span> *key_material = NULL;
    <span class="keywordtype">size_t</span> key_material_len;
    <span class="keywordtype">char</span> *iv_material = NULL;
    <span class="keywordtype">size_t</span> iv_material_len;
    <span class="keywordtype">char</span> *temp_material = NULL;
    <span class="keywordtype">size_t</span> temp_material_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Key generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a7c862b36aa6379f365a4110d3e953a93">YACA_KEY_TYPE_DH_PRIV</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa2143ee6d0bbd738529a889886e1406fa835b74e6d7d6ba2fbda96b55d30dd4c5">YACA_KEY_LENGTH_DH_RFC_2048_256</a>, &amp;priv_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080" title="Extracts public key from a private one.">yaca_key_extract_public</a>(priv_key, &amp;pub_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Send own public key and get peer public key */</span>
    peer_key = exchange_public_keys(pub_key);
    <span class="keywordflow">if</span> (peer_key == <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Derive shared secret */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3a0839e86b7d111f214a6b464af272d1" title="Derives a shared secret using Diffie-Helmann or EC Diffie-Helmann key exchange protocol.">yaca_key_derive_dh</a>(priv_key, peer_key, &amp;secret, &amp;secret_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Derive AES key and IV */</span>
    key_material_len = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a> / 8;
    iv_material_len = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa7b38fac947ab0f3eaf5e34af3125ad7c">YACA_KEY_LENGTH_IV_128BIT</a> / 8;
    temp_material_len = key_material_len + iv_material_len;
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga6a69d8ae43b86fab23d08a5ced8de81e" title="Derives a key material from shared secret.">yaca_key_derive_kdf</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9094a0341da41cafae21426bc7df690a67647e64d05dca7b5e667bc554d5788e">YACA_KDF_X942</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga20e009181e31bb8abd26bcf426a19edaa6179afafe4e0ddee42e0be05fa027a15">YACA_DIGEST_SHA512</a>, secret, secret_len,
                              NULL, 0, temp_material_len, &amp;temp_material);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    key_material = temp_material;
    iv_material = temp_material + key_material_len;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, NULL, key_material, key_material_len, &amp;aes_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a37c12b52b64bac9d7728c497713966bf">YACA_KEY_TYPE_IV</a>, NULL, iv_material, iv_material_len, &amp;iv);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* display key and IV in hexadecimal format */</span>
    dump_hex(key_material, key_material_len, <span class="stringliteral">&quot;***** Derived AES key: *****&quot;</span>);
    dump_hex(iv_material, iv_material_len, <span class="stringliteral">&quot;\n***** Derived IV: *****&quot;</span>);

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(priv_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(pub_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(peer_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(aes_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(iv);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(secret);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(temp_material);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><p> Key wrapping API example </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;yaca_crypto.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_simple.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_encrypt.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_key.h&gt;</span>
<span class="preprocessor">#include &lt;yaca_error.h&gt;</span>

<span class="comment">/* include helpers functions and definitions */</span>
<span class="preprocessor">#include &quot;misc.h&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keywordtype">int</span> ret;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> aes_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4" title="The handle of a key, an Initialization Vector or a key generation parameters.">yaca_key_h</a> iv = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;
    <span class="keywordtype">size_t</span> iv_bit_len;

    <span class="keywordtype">char</span> *aes_key_data = NULL;
    <span class="keywordtype">size_t</span> aes_key_data_len;
    <span class="keywordtype">char</span> *wrapped_key_data = NULL;
    <span class="keywordtype">size_t</span> wrapped_key_data_len;

    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae5302dc94d6b66fe8db2afc3ae43369b" title="Initializes the library. Must be called before any other crypto function. Should be called once in ea...">yaca_initialize</a>();
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Generate key to wrap */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>, &amp;aes_key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* Key generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>, &amp;key);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="comment">/* IV generation */</span>
    ret = <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gada6a5b7ecfdd5666e67a17110948cd1b" title="Returns the recommended/default length of the Initialization Vector for a given encryption configurat...">yaca_encrypt_get_iv_bit_length</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga5122956710d079a094631af35bae8ea9a85a89a16d89146367148cadc5bfc5491">YACA_ENCRYPT_AES</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga223360bb16b3bc063ede8539141e7413a9b146bc190a7edcd33d0b7a3f0591181">YACA_BCM_WRAP</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga3c557fe6ee325c3bbdc977996836baafa05c6f6c6bbb3b99485ba0ba3898c7dff">YACA_KEY_LENGTH_256BIT</a>,
                                         &amp;iv_bit_len);
    <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
        <span class="keywordflow">goto</span> exit;

    <span class="keywordflow">if</span> (iv_bit_len &gt; 0) {
        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a37c12b52b64bac9d7728c497713966bf">YACA_KEY_TYPE_IV</a>, iv_bit_len, &amp;iv);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;
    }

    <span class="comment">/* Key wrapping */</span>
    {
        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export</a>(aes_key, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a903f65488b202e5ea0158d49502dbe47">YACA_KEY_FILE_FORMAT_RAW</a>, NULL,
                              &amp;aes_key_data, &amp;aes_key_data_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__SIMPLE__MODULE.html#ga6a73dddb3154c0b63956874ad21cd517" title="Encrypts data using a symmetric cipher.">yaca_simple_encrypt</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga5122956710d079a094631af35bae8ea9a85a89a16d89146367148cadc5bfc5491">YACA_ENCRYPT_AES</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga223360bb16b3bc063ede8539141e7413a9b146bc190a7edcd33d0b7a3f0591181">YACA_BCM_WRAP</a>, key, iv,
                                  aes_key_data, aes_key_data_len,
                                  &amp;wrapped_key_data, &amp;wrapped_key_data_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* display key in hexadecimal format */</span>
        dump_hex(aes_key_data, aes_key_data_len, <span class="stringliteral">&quot;***** Unwrapped key:*****&quot;</span>);
        dump_hex(wrapped_key_data, wrapped_key_data_len, <span class="stringliteral">&quot;***** Wrapped key:*****&quot;</span>);
    }

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(aes_key_data);
    aes_key_data = NULL;
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(aes_key);
    aes_key = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5" title="NULL value for yaca_key_h type.">YACA_KEY_NULL</a>;

    <span class="comment">/* Key unwrapping */</span>
    {
        ret = <a class="code" href="group__CAPI__YACA__SIMPLE__MODULE.html#gac043c19112e227c40ca8ac10bb4bf87f" title="Decrypts data using a symmetric cipher.">yaca_simple_decrypt</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga5122956710d079a094631af35bae8ea9a85a89a16d89146367148cadc5bfc5491">YACA_ENCRYPT_AES</a>, <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga223360bb16b3bc063ede8539141e7413a9b146bc190a7edcd33d0b7a3f0591181">YACA_BCM_WRAP</a>, key, iv,
                                  wrapped_key_data, wrapped_key_data_len,
                                  &amp;aes_key_data, &amp;aes_key_data_len);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        ret = <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import</a>(<a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8ec1e334369bfa3a1aa2cca65bfc99a8a1aa2f34c3a38acd02c1a7a55410efaac">YACA_KEY_TYPE_SYMMETRIC</a>, NULL, aes_key_data, aes_key_data_len,
                              &amp;aes_key);
        <span class="keywordflow">if</span> (ret != <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a>)
            <span class="keywordflow">goto</span> exit;

        <span class="comment">/* display key in hexadecimal format */</span>
        dump_hex(aes_key_data, aes_key_data_len, <span class="stringliteral">&quot;***** Unwrapped key:*****&quot;</span>);
    }

exit:
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(aes_key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(key);
    <a class="code" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy</a>(iv);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(aes_key_data);
    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free</a>(wrapped_key_data);

    <a class="code" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga27d8af94a471ff514edb522df030323e" title="Cleans up the library. Must be called before exiting the thread that called yaca_initialize().">yaca_cleanup</a>();
    <span class="keywordflow">return</span> ret;
}
</pre></div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga456fbd03f78733d18e94da2d3eaff703">yaca_key_get_type</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> key, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a> *key_type)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets key's type.  <a href="#ga456fbd03f78733d18e94da2d3eaff703"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga098dfe417d7cd1b6760f3b945a8e9f72">yaca_key_get_bit_length</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> key, size_t *key_bit_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets key's length (in bits).  <a href="#ga098dfe417d7cd1b6760f3b945a8e9f72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103">yaca_key_import</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a> key_type, const char *password, const char *data, size_t data_len, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Imports a key or key generation parameters.  <a href="#gaa7c4905801564f218507d94dcb3cf103"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf">yaca_key_export</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> key, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae33194432e25887350bdc006c981e2a6">yaca_key_format_e</a> key_fmt, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8008d2162fd1645ceebe8a8413c16ff1">yaca_key_file_format_e</a> key_file_fmt, const char *password, char **data, size_t *data_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Exports a key or key generation parameters to arbitrary format.  <a href="#ga3711c649781f869d001aaabcd4d7d6bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3">yaca_key_generate</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a> key_type, size_t key_bit_len, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a secure key or key generation parameters (or an Initialization Vector).  <a href="#gae5c9e9984ec6852265c2197196047de3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c">yaca_key_generate_from_parameters</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> params, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *prv_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a secure private asymmetric key from parameters.  <a href="#ga55085d6abe97e176efd5c20570134f2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080">yaca_key_extract_public</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> prv_key, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *pub_key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts public key from a private one.  <a href="#ga72cd6ca031b7785f1b9ce35506ac9080"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gab5b21da412ea9063e9a03f680e19ddc5">yaca_key_extract_parameters</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> key, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *params)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts parameters from a private or a public key.  <a href="#gab5b21da412ea9063e9a03f680e19ddc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3a0839e86b7d111f214a6b464af272d1">yaca_key_derive_dh</a> (const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> prv_key, const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> pub_key, char **secret, size_t *secret_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a shared secret using Diffie-Helmann or EC Diffie-Helmann key exchange protocol.  <a href="#ga3a0839e86b7d111f214a6b464af272d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga6a69d8ae43b86fab23d08a5ced8de81e">yaca_key_derive_kdf</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa9094a0341da41cafae21426bc7df690">yaca_kdf_e</a> kdf, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo, const char *secret, size_t secret_len, const char *info, size_t info_len, size_t key_material_len, char **key_material)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key material from shared secret.  <a href="#ga6a69d8ae43b86fab23d08a5ced8de81e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa21f7c64d8e2541b8305b9fa122352bf">yaca_key_derive_pbkdf2</a> (const char *password, const char *salt, size_t salt_len, size_t iterations, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a> algo, size_t key_bit_len, <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives a key from user password (PKCS #5 a.k.a. pbkdf2 algorithm).  <a href="#gaa21f7c64d8e2541b8305b9fa122352bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377">yaca_key_destroy</a> (<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the key created by the library. Passing YACA_KEY_NULL is allowed.  <a href="#ga692d609dc6c94e922bb10a4f7a9b3377"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5">YACA_KEY_NULL</a>&#160;&#160;&#160;((<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>) NULL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">NULL value for yaca_key_h type.  <a href="#gae4a4f095aadbd45217b079c359334ec5"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gae4a4f095aadbd45217b079c359334ec5"></a><!-- doxytag: member="yaca_key.h::YACA_KEY_NULL" ref="gae4a4f095aadbd45217b079c359334ec5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae4a4f095aadbd45217b079c359334ec5">YACA_KEY_NULL</a>&#160;&#160;&#160;((<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>) NULL)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NULL value for yaca_key_h type. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0 </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga3a0839e86b7d111f214a6b464af272d1"></a><!-- doxytag: member="yaca_key.h::yaca_key_derive_dh" ref="ga3a0839e86b7d111f214a6b464af272d1" args="(const yaca_key_h prv_key, const yaca_key_h pub_key, char **secret, size_t *secret_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3a0839e86b7d111f214a6b464af272d1">yaca_key_derive_dh</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>prv_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>pub_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>secret_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derives a shared secret using Diffie-Helmann or EC Diffie-Helmann key exchange protocol. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>secret</em> should not be used as a symmetric key, to produce a symmetric key pass the secret to a key derivation function (KDF) or a message digest function.</dd>
<dd>
The <em>secret</em> should be freed with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prv_key</td><td>Our private key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pub_key</td><td>Peer public key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">secret</td><td>Generated shared secret </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">secret_len</td><td>Size of the shared secret</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (invalid <em>prv_key</em> or <em>pub_key</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga6a69d8ae43b86fab23d08a5ced8de81e" title="Derives a key material from shared secret.">yaca_key_derive_kdf()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__SIMPLE__MODULE.html#ga924aa791b3e0817f2eeee6c593affd35" title="Calculates a digest of a message.">yaca_simple_calculate_digest()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga6a69d8ae43b86fab23d08a5ced8de81e"></a><!-- doxytag: member="yaca_key.h::yaca_key_derive_kdf" ref="ga6a69d8ae43b86fab23d08a5ced8de81e" args="(yaca_kdf_e kdf, yaca_digest_algorithm_e algo, const char *secret, size_t secret_len, const char *info, size_t info_len, size_t key_material_len, char **key_material)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga6a69d8ae43b86fab23d08a5ced8de81e">yaca_key_derive_kdf</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa9094a0341da41cafae21426bc7df690">yaca_kdf_e</a>&#160;</td>
          <td class="paramname"><em>kdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>secret_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>info_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_material_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>key_material</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derives a key material from shared secret. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>info</em> parameter is ANSI X9.42 OtherInfo or ANSI X9.62 SharedInfo structure, more information can be found in ANSI X9.42/62 standard specification.</dd>
<dd>
The <em>key_material</em> or separate parts of it can be used to import a symmetric key with <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a>.</dd>
<dd>
The <em>key_material</em> should be freed using <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">kdf</td><td>Key derivation function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that should be used in key derivation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Shared secret </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret_len</td><td>Size of the shared secret </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Optional additional info, use NULL if not appending extra info </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info_len</td><td>Length of additional info, use 0 if not using additional info </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_material_len</td><td>Length of a key material to be generated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key_material</td><td>Newly generated key material</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>algo</em> or <em>kdf</em>) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa9094a0341da41cafae21426bc7df690" title="Enumeration of YACA key derivation functions.">yaca_kdf_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3a0839e86b7d111f214a6b464af272d1" title="Derives a shared secret using Diffie-Helmann or EC Diffie-Helmann key exchange protocol.">yaca_key_derive_dh()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa21f7c64d8e2541b8305b9fa122352bf"></a><!-- doxytag: member="yaca_key.h::yaca_key_derive_pbkdf2" ref="gaa21f7c64d8e2541b8305b9fa122352bf" args="(const char *password, const char *salt, size_t salt_len, size_t iterations, yaca_digest_algorithm_e algo, size_t key_bit_len, yaca_key_h *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa21f7c64d8e2541b8305b9fa122352bf">yaca_key_derive_pbkdf2</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>salt_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda">yaca_digest_algorithm_e</a>&#160;</td>
          <td class="paramname"><em>algo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_bit_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Derives a key from user password (PKCS #5 a.k.a. pbkdf2 algorithm). </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>key</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>User password as a null-terminated string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>Salt, should be a non-empty string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt_len</td><td>Length of the salt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iterations</td><td>Number of iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algo</td><td>Digest algorithm that should be used in key generation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_bit_len</td><td>Length of a key (in bits) to be generated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>Newly generated key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>algo</em> or <em>key_bit_len</em> not dividable by 8) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga20e009181e31bb8abd26bcf426a19eda" title="Enumeration of YACA message digest algorithms.">yaca_digest_algorithm_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga692d609dc6c94e922bb10a4f7a9b3377"></a><!-- doxytag: member="yaca_key.h::yaca_key_destroy" ref="ga692d609dc6c94e922bb10a4f7a9b3377" args="(yaca_key_h key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377">yaca_key_destroy</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release the key created by the library. Passing YACA_KEY_NULL is allowed. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>Key to be released</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga3711c649781f869d001aaabcd4d7d6bf"></a><!-- doxytag: member="yaca_key.h::yaca_key_export" ref="ga3711c649781f869d001aaabcd4d7d6bf" args="(const yaca_key_h key, yaca_key_format_e key_fmt, yaca_key_file_format_e key_file_fmt, const char *password, char **data, size_t *data_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf">yaca_key_export</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae33194432e25887350bdc006c981e2a6">yaca_key_format_e</a>&#160;</td>
          <td class="paramname"><em>key_fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8008d2162fd1645ceebe8a8413c16ff1">yaca_key_file_format_e</a>&#160;</td>
          <td class="paramname"><em>key_file_fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Exports a key or key generation parameters to arbitrary format. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Everywhere where either a key (of any type) or an asymmetric key is referred in the documentation of this function key generator parameters are also included.</dd>
<dd>
This function exports the key to an arbitrary key format and key file format.</dd>
<dd>
For key formats two values are allowed:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a>: this is the only option possible in case of symmetric keys (or Initialization Vector), for asymmetric keys it will export to their default ASN1 structure format (e.g. PKCS#1, SSLeay, PKCS#3).</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6a2d1cb42106900c000653d3a06e851004">YACA_KEY_FORMAT_PKCS8</a>: this will only work for private asymmetric keys.</li>
</ul>
</dd>
<dd>
The following file formats are supported:<ul>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a903f65488b202e5ea0158d49502dbe47">YACA_KEY_FILE_FORMAT_RAW</a>: used only for symmetric, raw binary format</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a3a618b9622631e48e4a1e9bed6563e1a">YACA_KEY_FILE_FORMAT_BASE64</a>: used only for symmetric, BASE64 encoded binary form</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a>: used only for asymmetric, PEM file format</li>
<li><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1ab61e4cd29812bb76a23aa29278828822">YACA_KEY_FILE_FORMAT_DER</a>: used only for asymmetric, DER file format</li>
</ul>
</dd>
<dd>
Encryption is supported and optional for RSA/DSA private keys in the <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6acaddf656b49dea987ea4ed71f26a9b05">YACA_KEY_FORMAT_DEFAULT</a> with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gga8008d2162fd1645ceebe8a8413c16ff1a1d055ae00f23dfa8c8b3c22efe179c40">YACA_KEY_FILE_FORMAT_PEM</a> format. If no password is provided the exported key will be unencrypted. The encryption algorithm used in this case is AES-256-CBC.</dd>
<dd>
Encryption is obligatory for <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggae33194432e25887350bdc006c981e2a6a2d1cb42106900c000653d3a06e851004">YACA_KEY_FORMAT_PKCS8</a> format (for both, PEM and DER file formats). If no password is provided the <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a> will be returned. The encryption algorithm used in this case is AES-256-CBC. The key is generated from password using PBKDF2 with HMAC-SHA1 function and 2048 iterations.</dd>
<dd>
Encryption is not supported for the symmetric, public keys and key generation parameters in all their supported formats. If a password is provided in such case the <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a> will be returned.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to be exported </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_fmt</td><td>Format of the key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file_fmt</td><td>Format of the key file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>Password used for the encryption (can be NULL) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>Data, allocated by the library, containing exported key (must be freed with <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga76ecbbb314f46d1d0f590d0a0559a2b8" title="Frees the memory allocated by yaca_malloc(), yaca_zalloc(), yaca_realloc() or one of the cryptographi...">yaca_free()</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data_len</td><td>Size of the output data</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>key_fmt</em>, <em>key_file_fmt</em> or <em>data_len</em> too big) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gae33194432e25887350bdc006c981e2a6" title="Enumeration of YACA key formats.">yaca_key_format_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8008d2162fd1645ceebe8a8413c16ff1" title="Enumeration of YACA key file formats.">yaca_key_file_format_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gab5b21da412ea9063e9a03f680e19ddc5"></a><!-- doxytag: member="yaca_key.h::yaca_key_extract_parameters" ref="gab5b21da412ea9063e9a03f680e19ddc5" args="(const yaca_key_h key, yaca_key_h *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gab5b21da412ea9063e9a03f680e19ddc5">yaca_key_extract_parameters</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extracts parameters from a private or a public key. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>params</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>A key to extract the parameters from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">params</td><td>Extracted parameters</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td><em>key</em> is of invalid type or <em>params</em> is NULL </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c" title="Generates a secure private asymmetric key from parameters.">yaca_key_generate_from_parameters()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga72cd6ca031b7785f1b9ce35506ac9080"></a><!-- doxytag: member="yaca_key.h::yaca_key_extract_public" ref="ga72cd6ca031b7785f1b9ce35506ac9080" args="(const yaca_key_h prv_key, yaca_key_h *pub_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga72cd6ca031b7785f1b9ce35506ac9080">yaca_key_extract_public</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>prv_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>pub_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extracts public key from a private one. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>pub_key</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prv_key</td><td>Private key to extract the public one from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pub_key</td><td>Extracted public key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td><em>prv_key</em> is of invalid type or <em>pub_key</em> is NULL </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103" title="Imports a key or key generation parameters.">yaca_key_import()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gae5c9e9984ec6852265c2197196047de3"></a><!-- doxytag: member="yaca_key.h::yaca_key_generate" ref="gae5c9e9984ec6852265c2197196047de3" args="(yaca_key_type_e key_type, size_t key_bit_len, yaca_key_h *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3">yaca_key_generate</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a>&#160;</td>
          <td class="paramname"><em>key_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_bit_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates a secure key or key generation parameters (or an Initialization Vector). </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>This function is used to generate symmetric keys, private asymmetric keys or key generation parameters for key types that support them (DSA, DH and EC).</dd>
<dd>
Supported key lengths:<ul>
<li>RSA: length &gt;= 512bits</li>
<li>DSA: length &gt;= 512bits, multiple of 64</li>
<li>DH: a value taken from <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa2143ee6d0bbd738529a889886e1406f" title="Enumeration of YACA DH parameters taken from RFC 5114. It&#39;s meant to be passed or returned as a key_b...">yaca_key_bit_length_dh_rfc_e</a> or (YACA_KEY_LENGTH_DH_GENERATOR_* | prime_length_in_bits), where prime_length_in_bits can be any positive number</li>
<li>EC: a value taken from <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga6c3245122343a86ebe0b98731db96438" title="Enumeration of YACA elliptic curve types with their bit lengths. It&#39;s meant to be passed or returned ...">yaca_key_bit_length_ec_e</a></li>
</ul>
</dd>
<dd>
The <em>key</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key_type</td><td>Type of the key to be generated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_bit_len</td><td>Length of the key (in bits) to be generated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>Newly generated key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td><em>key</em> is NULL, incorrect <em>key_type</em> or <em>key_bit_len</em> is not dividable by 8 </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga3c557fe6ee325c3bbdc977996836baaf" title="Enumeration of YACA key lengths. It is possible to use arbitrary integer instead, this enum values ar...">yaca_key_bit_length_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa2143ee6d0bbd738529a889886e1406f" title="Enumeration of YACA DH parameters taken from RFC 5114. It&#39;s meant to be passed or returned as a key_b...">yaca_key_bit_length_dh_rfc_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gacc30cd58f6704e52f556b0f82113df9d" title="A value indicating generator equal 2 for DH parameters. To be or&#39;ed with safe prime length in bits...">YACA_KEY_LENGTH_DH_GENERATOR_2</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gade16200d627a664a68a9a4193d157236" title="A value indicating generator equal 5 for DH parameters. To be or&#39;ed with safe prime length in bits...">YACA_KEY_LENGTH_DH_GENERATOR_5</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga6c3245122343a86ebe0b98731db96438" title="Enumeration of YACA elliptic curve types with their bit lengths. It&#39;s meant to be passed or returned ...">yaca_key_bit_length_ec_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga55085d6abe97e176efd5c20570134f2c"></a><!-- doxytag: member="yaca_key.h::yaca_key_generate_from_parameters" ref="ga55085d6abe97e176efd5c20570134f2c" args="(const yaca_key_h params, yaca_key_h *prv_key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga55085d6abe97e176efd5c20570134f2c">yaca_key_generate_from_parameters</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>prv_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates a secure private asymmetric key from parameters. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>This function is used to generate private asymmetric keys based on pre-generated parameters.</dd>
<dd>
The <em>key</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td>Pre-generated parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prv_key</td><td>Newly generated private key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td><em>prv_key</em> is NULL or incorrect <em>params</em> </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gab5b21da412ea9063e9a03f680e19ddc5" title="Extracts parameters from a private or a public key.">yaca_key_extract_parameters()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga098dfe417d7cd1b6760f3b945a8e9f72"></a><!-- doxytag: member="yaca_key.h::yaca_key_get_bit_length" ref="ga098dfe417d7cd1b6760f3b945a8e9f72" args="(const yaca_key_h key, size_t *key_bit_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga098dfe417d7cd1b6760f3b945a8e9f72">yaca_key_get_bit_length</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>key_bit_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets key's length (in bits). </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>The <em>key</em> can be any symmetric (including an Initialization Vector) or asymmetric key (including key generation parameters).</dd>
<dd>
For Diffie-Helmann <em>key_bit_len</em> returns prime length in bits. Values used to generate the key/parameters in <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gae5c9e9984ec6852265c2197196047de3" title="Generates a secure key or key generation parameters (or an Initialization Vector).">yaca_key_generate()</a> are not restored. Neither generator number nor values from <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa2143ee6d0bbd738529a889886e1406f" title="Enumeration of YACA DH parameters taken from RFC 5114. It&#39;s meant to be passed or returned as a key_b...">yaca_key_bit_length_dh_rfc_e</a>.</dd>
<dd>
For Elliptic Curves <em>key_bit_len</em> returns values from <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga6c3245122343a86ebe0b98731db96438" title="Enumeration of YACA elliptic curve types with their bit lengths. It&#39;s meant to be passed or returned ...">yaca_key_bit_length_ec_e</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key which length we return </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key_bit_len</td><td>Key length in bits</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Either of the params is NULL </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga3c557fe6ee325c3bbdc977996836baaf" title="Enumeration of YACA key lengths. It is possible to use arbitrary integer instead, this enum values ar...">yaca_key_bit_length_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gaa2143ee6d0bbd738529a889886e1406f" title="Enumeration of YACA DH parameters taken from RFC 5114. It&#39;s meant to be passed or returned as a key_b...">yaca_key_bit_length_dh_rfc_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga6c3245122343a86ebe0b98731db96438" title="Enumeration of YACA elliptic curve types with their bit lengths. It&#39;s meant to be passed or returned ...">yaca_key_bit_length_ec_e</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga456fbd03f78733d18e94da2d3eaff703"></a><!-- doxytag: member="yaca_key.h::yaca_key_get_type" ref="ga456fbd03f78733d18e94da2d3eaff703" args="(const yaca_key_h key, yaca_key_type_e *key_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga456fbd03f78733d18e94da2d3eaff703">yaca_key_get_type</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a> *&#160;</td>
          <td class="paramname"><em>key_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets key's type. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key which type we return </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key_type</td><td>Key type</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Either of the params is NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa7c4905801564f218507d94dcb3cf103"></a><!-- doxytag: member="yaca_key.h::yaca_key_import" ref="gaa7c4905801564f218507d94dcb3cf103" args="(yaca_key_type_e key_type, const char *password, const char *data, size_t data_len, yaca_key_h *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#gaa7c4905801564f218507d94dcb3cf103">yaca_key_import</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8">yaca_key_type_e</a>&#160;</td>
          <td class="paramname"><em>key_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#gab65dc47aa98f28e9bf7afc4c1870ebb4">yaca_key_h</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Imports a key or key generation parameters. </p>
<dl class="user"><dt><b>Since :</b></dt><dd>3.0</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Everywhere where either a key (of any type) or an asymmetric key is referred in the documentation of this function key generator parameters are also included.</dd>
<dd>
This function imports a key trying to match it to the <em>key_type</em> specified. It should autodetect both the key format and the file format.</dd>
<dd>
For symmetric, Initialization Vector and DES keys RAW binary format and BASE64 encoded binary format are supported. For asymmetric keys PEM and DER file formats are supported.</dd>
<dd>
Asymmetric keys can be in their default ASN1 structure formats (like PKCS#1, SSleay or PKCS#3). Private asymmetric keys can also be in PKCS#8 format. Additionally it is possible to import public RSA/DSA/EC keys from X509 certificate.</dd>
<dd>
If the key is encrypted the algorithm will be autodetected and password used. If it's not known if the key is encrypted one should pass NULL as password and check for the <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4adbb893fd0d6bb79e0ebc98523a5da5d7">YACA_ERROR_INVALID_PASSWORD</a> return code.</dd>
<dd>
If the imported key will be detected as a format that does not support encryption and password was passed <a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a> will be returned. For a list of keys and formats that do support encryption see <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export()</a> documentation.</dd>
<dd>
The <em>key</em> should be released using <a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a>.</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">key_type</td><td>Type of the key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>Null-terminated password for the key (can be NULL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Blob containing the key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>Size of the blob </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">key</td><td>Returned key</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a> on success, negative on error </dd></dl>
<dl class="retval"><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a94c3616de03ab18226d4ecaf80173385">YACA_ERROR_NONE</a></td><td>Successful </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a82fb6f4c6ab7a72e4d00e181b8caf90f">YACA_ERROR_INVALID_PARAMETER</a></td><td>Required parameters have incorrect values (NULL, 0, invalid <em>key_type</em> or <em>data_len</em> too big) </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4a9abb2023e6601c9f29b09c5ba16ee836">YACA_ERROR_OUT_OF_MEMORY</a></td><td>Out of memory error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4aaee7a0f1bf0b5f2a991563289fb81d25">YACA_ERROR_INTERNAL</a></td><td>Internal error </td></tr>
    <tr><td class="paramname"><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ggaa9b2a74a8668b5255c3a5970d8b618a4adbb893fd0d6bb79e0ebc98523a5da5d7">YACA_ERROR_INVALID_PASSWORD</a></td><td>Invalid <em>password</em> given or <em>password</em> was required and none was given</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__CAPI__YACA__ENCRYPTION__MODULE.html#ga8ec1e334369bfa3a1aa2cca65bfc99a8" title="Enumeration of YACA key types, Initialization Vector is considered as key.">yaca_key_type_e</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga3711c649781f869d001aaabcd4d7d6bf" title="Exports a key or key generation parameters to arbitrary format.">yaca_key_export()</a> </dd>
<dd>
<a class="el" href="group__CAPI__YACA__KEY__MODULE.html#ga692d609dc6c94e922bb10a4f7a9b3377" title="Release the key created by the library. Passing YACA_KEY_NULL is allowed.">yaca_key_destroy()</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
