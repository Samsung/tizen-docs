<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tizen Native API: Entry - Example of simple editing</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_html_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Tizen Native API"/>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tizen Native API
   &#160;<span id="projectnumber">4.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>The&#160;Basics&#160;of&#160;Tizen&#160;Native&#160;API&#160;Reference</span></a></li>
      <li><a href="modules.html"><span>Native&#160;API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('entry_example.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Entry - Example of simple editing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As a general overview of <a class="el" href="group__Elm__Entry.html">Entry</a> we are going to write an, albeit simple, functional editor. Although intended to show how elm_entry works, this example also makes extensive use of several other widgets. The full code can be found in <a class="el" href="entry_example_8c-example.html">entry_example.c</a> and in the following lines we'll go through the parts especific to the <a class="el" href="group__Elm__Entry.html">Entry</a> widget.</p>
<p>The program itself is a simple editor, with a file already set to it, that can be set to autosave or not and allows insertion of emoticons and some formatted text. As of this writing, the capabilities of format edition in the entry are very limited, so a lot of manual work is required to change the current text.</p>
<p>In any case, the program allows some changes by using the buttons on the top of the window and returning focus back to the main entry afterwards.</p>
<div class="image">
<img src="screenshots/entry_example.png" alt="entry_example.png"/>
</div>
 <p>We'll begin by showing a few structures used throught the program. First, the application owns data that holds the main window and the main entry where the editting happens. Then, an auxiliar structure we'll use later when inserting icons in our text.  <div class="fragment"><pre class="fragment"></pre></div></p>
<p>A little convenience function will insert whatever text we need in the buffer at the current cursor's position and set focus back to this entry. This is done mostly because clicking on any button will make them steal focus, which makes writing text more cumbersome. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>One of the buttons on the top will trigger an <a class="el" href="group__Elm__Inwin.html">Inwin</a> to open and show us several icons we can insert into the text. We'll jump over most of these functions, but when all the options are chosen, we insert the special markup text that will show the chosen icon in place. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>As can be seen in that function, the program lets us add icons to our entry using all the possible configurations for them. That should help to clarify how the different combinations work out by actually seeing them in action.</p>
<p>The same popup window has a page to set the settings of the chosen icon, that is, the size and how the item will be placed within the line.</p>
<p>The size is done with two entries, limitted to accept numbers and a fixed size of characters. Changing the value in this entries will update the icon size in our struct as seen in the next two callbacks. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The rest of the options are handled with radio buttons, since only one type of size can be used (<code>size</code>, <code>absize</code> or <code>relsize</code>) and for the vertical sizing it needs to choose between <code>ascent</code> and <code>full</code>. Depending on which is chosen, the <code>item</code> tag is formed accordingly as seen before. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>The first of our entries is here. There's something worth mentioning about the way we'll create this one. Normally, any entry regardless of whether is single line or not, will be set to scrollable, but in this case, since we are limitting how many characters can fit in them and we know we don't need scrolling, we are not setting this flag. This makes the entry have virtually no appearance on screen, other than its text. This is because an entry is just that, a box that holds text, and in order to have some frame around it or a background color, another widget needs to provide this. When an entry is scrollable, the same scroller used internally does this. We are using frames here to provide some decoration around, then creating our entries, set them to single line, add our two filters and the callback for when their value change. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>This function ends with the button that will finally call the item into our editting string. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Then we get to the format edition. Here we can add the <code>bold</code> and <code>emphasis</code> tags to parts of our text. There's a lot of manual work to know what to do here, since we are not implementing an entire state manager and the entry itself doesn't, yet, support all the needed capabilities to make this simpler. We begin by getting the format we are using in our function from the button pressed. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Next we need to find out if we need to insert an opening or a closing tag. For this, we store the current cursor position and create a selection from this point until the beginning of our text, and then get the selected text to look for any existing format tags in it. This is currently the only way in which we can find out what formats is being used in the entry. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Once we know what tag to insert, we need a second check in the case it was a closing tag. This is because any other closing tag that comes after would be left dangling alone, so we need to remove it to keep the text consistent. <div class="fragment"><pre class="fragment"></pre></div> Finally, we clear our fake selections and return the cursor back to the position it had at first, since there is where we want to insert our format. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>And finish by calling our convenience function from before, to insert the text at the current cursor and give focus back to the entry. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>A checkbox on the top of our program tells us if the text we are editing will autosave or not. In it's <code>"changed"</code> callback we get the value from the checkbox and call the <a class="el" href="group__Elm__Entry.html#gaf11dbad4cd1e5309fb655910e4f14771" title="This sets the entry object to &#39;autosave&#39; the loaded text file or not.">elm_entry_autosave_set()</a> function with it. If autosave is set, we also call <a class="el" href="group__Elm__Entry.html#gaa44cb80b64207a3706fad36d35e92bc7" title="This function writes any changes made to the file set with elm_entry_file_set.">elm_entry_file_save()</a>. This is so the internal timer used to periodically store to disk our changes is started. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>Two more functions to show some cursor playing. Whenever we double click anywhere on our entry, we'll find what word is the cursor placed at and select it. Likewise, for triple clicking, we select the entire line. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>And finally, the main window of the program contains the entry where we do all the edition and some helping widgets to change format, add icons or change the autosave flag. <div class="fragment"><pre class="fragment"></pre></div></p>
<p>And the main entry of the program. Set to scroll, by default we disable autosave and we'll begin with a file set to it because no file selector is being used here. The file is loaded with #ELM_TEXT_FORMAT_MARKUP_UTF8 so that any format contained in it is interpreted, otherwise the entry would load it as just text, escaping any tags found and no format or icons would be shown. Then we connect to the double and triple click signals and set focus on the entry so we can start typing right away. <div class="fragment"><pre class="fragment"></pre></div> </p>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
<hr size="1"/>
<center>
<small>Except as noted, this content - excluding the Code Examples - is licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode" target="_blank">Creative Commons Attribution 3.0</a>
and all of the Code Examples contained herein are licensed under <a href="https://www.tizen.org/bsd-3-clause-license" target="_blank">BSD-3-Clause</a>.<br/>For details, see the <a href="https://www.tizen.org/content-license" target="_blank">Content License</a>.&nbsp;</small>
</center>
</body>
</html>
